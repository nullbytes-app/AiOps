{"openapi":"3.1.0","info":{"title":"AI Agents","description":"Multi-tenant AI enhancement platform for MSP technicians","version":"0.1.0"},"paths":{"/api/auth/register":{"post":{"tags":["Authentication"],"summary":"Register new user","description":"Register new user with email and password.\n\nArgs:\n    request_data: RegisterRequest with email, password, default_tenant_id\n    db: Database session\n    user_service: User service\n\nReturns:\n    UserResponse with user details (no password)\n\nRaises:\n    400: Email already exists\n    422: Validation error (weak password, invalid email)\n    500: Database error\n\nSecurity:\n    - Password validated for strength before hashing\n    - Password hashed with bcrypt (10 rounds)\n    - Email uniqueness enforced by database constraint","operationId":"register_api_auth_register_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RegisterRequest"}}},"required":true},"responses":{"201":{"description":"User successfully registered","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/token":{"post":{"tags":["Authentication"],"summary":"OAuth2 compatible token login","description":"OAuth2 compatible token endpoint.\n\nUses OAuth2PasswordRequestForm for standard compatibility:\n- username field contains email\n- password field contains password\n\nArgs:\n    form_data: OAuth2 form with username/password\n    request: FastAPI request for IP/user-agent extraction\n    db: Database session\n    auth_service: Authentication service\n    user_service: User service\n\nReturns:\n    TokenResponse with access_token, refresh_token, token_type\n\nRaises:\n    401: Invalid credentials or account locked\n    429: Rate limit exceeded\n\nSecurity:\n    - Account lockout after 5 failed attempts (15 min lockout)\n    - Failed attempts logged to auth_audit_log\n    - Generic error message (prevents user enumeration)","operationId":"login_api_auth_token_post","requestBody":{"content":{"application/x-www-form-urlencoded":{"schema":{"$ref":"#/components/schemas/Body_login_api_auth_token_post"}}},"required":true},"responses":{"200":{"description":"Access token and refresh token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/refresh":{"post":{"tags":["Authentication"],"summary":"Refresh access token","description":"Get new access token using refresh token.\n\nArgs:\n    request_data: RefreshRequest with refresh_token\n    db: Database session\n    auth_service: Authentication service\n    user_service: User service\n\nReturns:\n    TokenResponse with new access_token (same refresh_token)\n\nRaises:\n    401: Invalid or expired refresh token\n    401: Token has been revoked\n\nSecurity:\n    - Refresh token verified (signature, expiration, blacklist)\n    - User must still exist and be active\n    - Does NOT rotate refresh token (30-day TTL acceptable)","operationId":"refresh_token_api_auth_refresh_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/RefreshRequest"}}},"required":true},"responses":{"200":{"description":"New access token using refresh token","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TokenResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/auth/logout":{"post":{"tags":["Authentication"],"summary":"Logout user","description":"Logout user by revoking access and refresh tokens.\n\nArgs:\n    current_user: Authenticated user from dependency\n    request_data: LogoutRequest with tokens to revoke\n    auth_service: Authentication service\n    db: Database session\n\nReturns:\n    204 No Content\n\nSide Effects:\n    - Adds both tokens to Redis blacklist\n    - Logs logout event to auth_audit_log\n\nSecurity:\n    - Requires valid access token to logout\n    - Both access and refresh tokens added to blacklist\n    - TTL on blacklist entries matches token expiration","operationId":"logout_api_auth_logout_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/LogoutRequest"}}},"required":true},"responses":{"204":{"description":"Successfully logged out"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"JWT":[]}]}},"/api/users/me":{"get":{"tags":["Users"],"summary":"Get current user profile","description":"Get authenticated user's profile with roles.\n\nArgs:\n    current_user: User from JWT token\n    db: Database session\n\nReturns:\n    UserDetailResponse with user details and roles\n\nSecurity:\n    Requires valid JWT access token\n\nExample:\n    GET /api/users/me\n    Headers: Authorization: Bearer <access_token>","operationId":"get_current_user_profile_api_users_me_get","responses":{"200":{"description":"Current authenticated user details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/UserDetailResponse"}}}}},"security":[{"JWT":[]}]}},"/api/users/me/password":{"put":{"tags":["Users"],"summary":"Change password","description":"Change user password with validation.\n\nArgs:\n    current_user: Authenticated user\n    request_data: ChangePasswordRequest with old and new passwords\n    db: Database session\n    auth_service: Authentication service\n\nReturns:\n    204 No Content\n\nRaises:\n    400: Current password incorrect\n    422: New password fails strength validation\n    422: New password matches recent password (password history)\n\nSide Effects:\n    - Updates password_hash\n    - Appends to password_history\n    - Revokes all existing tokens (force re-login)\n\nSecurity:\n    - Current password verified before changing\n    - New password validated for strength\n    - New password checked against password history (prevent reuse)\n    - All tokens revoked to force re-authentication\n    - Password change logged to auth_audit_log","operationId":"change_password_api_users_me_password_put","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ChangePasswordRequest"}}},"required":true},"responses":{"204":{"description":"Password successfully changed"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}},"security":[{"JWT":[]}]}},"/webhook/servicedesk":{"post":{"tags":["webhooks"],"summary":"Receive ServiceDesk Plus webhook notification","description":"Accepts webhook notifications from ServiceDesk Plus when tickets are created or updated. Validates the payload using tenant-specific webhook secret via Plugin Manager and returns 202 Accepted immediately while queuing the ticket for enhancement processing. Uses tenant-specific configuration for ServiceDesk Plus credentials and enhancement preferences. Supports multi-tool routing via plugin architecture (Story 7.3).","operationId":"receive_webhook_webhook_servicedesk_post","parameters":[{"name":"X-ServiceDesk-Signature","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Servicedesk-Signature"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/WebhookPayload"}}}},"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/WebhookResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/webhook/servicedesk/resolved-ticket":{"post":{"tags":["webhooks"],"summary":"Receive resolved ticket webhook from ServiceDesk Plus","description":"Accepts webhook notifications from ServiceDesk Plus when tickets are marked as resolved or closed. Validates the payload and signature, then stores the ticket in ticket_history asynchronously for context gathering. Returns 202 Accepted immediately without blocking on storage.","operationId":"store_resolved_ticket_webhook_servicedesk_resolved_ticket_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ResolvedTicketWebhook"}}},"required":true},"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/WebhookResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/webhook/agents/{agent_id}/webhook":{"post":{"tags":["webhooks","agent-webhooks"],"summary":"Agent webhook endpoint for external trigger","description":"Accepts webhook requests to trigger agent execution. Validates HMAC-SHA256 signature, validates payload against agent's payload_schema (if defined), and enqueues agent execution task to Celery. Returns 202 Accepted immediately with execution_id for tracking.","operationId":"agent_webhook_endpoint_webhook_agents__agent_id__webhook_post","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}},{"name":"X-Hub-Signature-256","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Hub-Signature-256"}}],"responses":{"202":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Agent Webhook Endpoint Webhook Agents  Agent Id  Webhook Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/health":{"get":{"tags":["health"],"summary":"Health Check","description":"Health check endpoint for monitoring.\n\nValidates connectivity to PostgreSQL and Redis dependencies.\nUsed by Docker health checks and load balancers.\n\nReturns:\n    dict: Health status with dependency checks\n\nRaises:\n    HTTPException: If any dependency is unhealthy","operationId":"health_check_api_v1_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"anyOf":[{"type":"string"},{"additionalProperties":true,"type":"object"}]},"type":"object","title":"Response Health Check Api V1 Health Get"}}}}}}},"/api/v1/ready":{"get":{"tags":["health"],"summary":"Readiness Check","description":"Readiness check endpoint for Kubernetes.\n\nChecks if the application is ready to accept traffic by validating\nall critical dependencies (database and Redis).\n\nReturns:\n    dict: Readiness status with dependency checks\n\nRaises:\n    HTTPException: If service is not ready","operationId":"readiness_check_api_v1_ready_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"anyOf":[{"type":"string"},{"additionalProperties":true,"type":"object"}]},"type":"object","title":"Response Readiness Check Api V1 Ready Get"}}}}}}},"/api/v1/health/litellm":{"get":{"tags":["health"],"summary":"Litellm Health Check","description":"LiteLLM proxy health check endpoint (Story 8.9).\n\nTests connectivity to LiteLLM proxy and validates master key.\nUsed for monitoring LiteLLM integration health.\n\nArgs:\n    db: Database session for LLMService initialization\n\nReturns:\n    dict: LiteLLM health status with proxy and master key validation\n\nRaises:\n    HTTPException(503): If LiteLLM proxy is unavailable or master key invalid","operationId":"litellm_health_check_api_v1_health_litellm_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Litellm Health Check Api V1 Health Litellm Get"}}}}}}},"/api/v1/tenants/{tenant_id}/validate-llm-key":{"get":{"tags":["health"],"summary":"Validate Tenant Llm Key","description":"Validate tenant's LiteLLM virtual key (Story 8.9).\n\nTests if tenant's virtual key is valid and not expired/blocked.\nUsed for troubleshooting tenant LLM integration issues.\n\nArgs:\n    tenant_id: Tenant identifier\n    db: Database session\n\nReturns:\n    dict: Validation result with key status\n\nRaises:\n    HTTPException(404): If tenant not found\n    HTTPException(400): If tenant has no virtual key","operationId":"validate_tenant_llm_key_api_v1_tenants__tenant_id__validate_llm_key_get","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Validate Tenant Llm Key Api V1 Tenants  Tenant Id  Validate Llm Key Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/tenants":{"post":{"tags":["admin-tenants"],"summary":"Create new tenant configuration","description":"Creates a new tenant configuration with ServiceDesk Plus credentials and preferences. Sensitive fields (api_key, webhook_secret) are encrypted before storage. Requires admin authentication via X-Admin-Key header.","operationId":"create_tenant_admin_tenants_post","parameters":[{"name":"X-Admin-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantConfigCreate"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantConfigResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["admin-tenants"],"summary":"List all tenant configurations","description":"Returns paginated list of all tenant configurations with masked sensitive fields. Requires admin authentication via X-Admin-Key header.","operationId":"list_tenants_admin_tenants_get","parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","default":0,"title":"Skip"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","default":50,"title":"Limit"}},{"name":"X-Admin-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantConfigListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/tenants/{tenant_id}":{"get":{"tags":["admin-tenants"],"summary":"Get specific tenant configuration","description":"Retrieves configuration for a specific tenant with masked sensitive fields. Requires admin authentication via X-Admin-Key header.","operationId":"get_tenant_admin_tenants__tenant_id__get","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"X-Admin-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantConfigResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["admin-tenants"],"summary":"Update tenant configuration","description":"Updates tenant configuration. All fields are optional. Sensitive fields (api_key, webhook_secret) are encrypted before storage. Cache is invalidated on update to ensure freshness. Requires admin authentication via X-Admin-Key header.","operationId":"update_tenant_admin_tenants__tenant_id__put","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"X-Admin-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantConfigUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantConfigResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["admin-tenants"],"summary":"Delete tenant configuration","description":"Soft deletes tenant (marks as inactive). Configuration remains in database for audit trail but becomes inactive and inaccessible. Can be reactivated via update. Requires admin authentication via X-Admin-Key header.","operationId":"delete_tenant_admin_tenants__tenant_id__delete","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"X-Admin-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Key"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/tenants/{tenant_id}/rotate-llm-key":{"post":{"tags":["admin-tenants"],"summary":"Rotate LiteLLM virtual key for tenant","description":"Generates new LiteLLM virtual key for tenant, invalidates old key, and updates database with encrypted new key. Audit log entry created. Requires admin authentication via X-Admin-Key header. Story 8.9: Virtual Key Management","operationId":"rotate_llm_key_admin_tenants__tenant_id__rotate_llm_key_post","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"X-Admin-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Rotate Llm Key Admin Tenants  Tenant Id  Rotate Llm Key Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/admin/tenants/{tenant_id}/budget-override":{"post":{"tags":["admin-tenants"],"summary":"Grant temporary budget override","description":"Admin-only: Grant temporary budget increase for a tenant (Story 8.10 AC#8)","operationId":"grant_budget_override_admin_tenants__tenant_id__budget_override_post","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"X-Admin-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BudgetOverrideRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Grant Budget Override Admin Tenants  Tenant Id  Budget Override Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["admin-tenants"],"summary":"Remove budget override","description":"Admin-only: Remove temporary budget override for a tenant (Story 8.10 AC#8)","operationId":"remove_budget_override_admin_tenants__tenant_id__budget_override_delete","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"X-Admin-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Remove Budget Override Admin Tenants  Tenant Id  Budget Override Delete"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/feedback/":{"post":{"tags":["feedback"],"summary":"Submit enhancement feedback","description":"Allows technicians to rate enhancement quality with thumbs up/down or 1-5 scale. Supports anonymous feedback (no email required) or attributed feedback with optional comments. Used for continuous quality monitoring, satisfaction tracking (AC2: >4/5 target), and data-driven roadmap prioritization. RLS ensures tenant isolation.","operationId":"submit_feedback_api_v1_feedback__post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/FeedbackSubmitRequest"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FeedbackResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["feedback"],"summary":"Retrieve feedback records","description":"Retrieves enhancement feedback with optional filters: date range, feedback type, pagination. Used for analyzing satisfaction trends, generating baseline metrics reports, and identifying improvement themes. RLS ensures tenant isolation (only returns feedback for authenticated tenant). Supports pagination via limit/offset for large datasets.","operationId":"get_feedback_api_v1_feedback__get","parameters":[{"name":"tenant_id","in":"query","required":true,"schema":{"type":"string","description":"Tenant identifier (must match RLS context)","title":"Tenant Id"},"description":"Tenant identifier (must match RLS context)"},{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"Filter by created_at >= start_date (ISO8601 format)","title":"Start Date"},"description":"Filter by created_at >= start_date (ISO8601 format)"},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"Filter by created_at <= end_date (ISO8601 format)","title":"End Date"},"description":"Filter by created_at <= end_date (ISO8601 format)"},{"name":"feedback_type","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/FeedbackType"},{"type":"null"}],"description":"Filter by feedback type (thumbs_up, thumbs_down, rating)","title":"Feedback Type"},"description":"Filter by feedback type (thumbs_up, thumbs_down, rating)"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":1000,"minimum":1,"description":"Maximum records to return (default 100, max 1000)","default":100,"title":"Limit"},"description":"Maximum records to return (default 100, max 1000)"},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","minimum":0,"description":"Pagination offset (default 0)","default":0,"title":"Offset"},"description":"Pagination offset (default 0)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/FeedbackListResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/feedback/stats":{"get":{"tags":["feedback"],"summary":"Get feedback statistics","description":"Returns aggregated feedback statistics: average rating (for AC2 target tracking: >4/5), feedback counts by type (for sentiment analysis), and positive feedback percentage. Used for baseline metrics reporting, weekly review dashboards, and success criteria validation.","operationId":"get_feedback_stats_api_v1_feedback_stats_get","parameters":[{"name":"tenant_id","in":"query","required":true,"schema":{"type":"string","description":"Tenant identifier (must match authenticated tenant)","title":"Tenant Id"},"description":"Tenant identifier (must match authenticated tenant)"},{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"Filter by created_at >= start_date (ISO8601 format)","title":"Start Date"},"description":"Filter by created_at >= start_date (ISO8601 format)"},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"description":"Filter by created_at <= end_date (ISO8601 format)","title":"End Date"},"description":"Filter by created_at <= end_date (ISO8601 format)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Feedback Stats Api V1 Feedback Stats Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/plugins/":{"get":{"tags":["plugins"],"summary":"List registered plugins","description":"Returns list of all registered plugins with metadata (name, type, version, status, description). Used by Streamlit admin UI to display available plugins for tenant assignment.","operationId":"list_plugins_api_v1_plugins__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PluginListResponse"}}}}}}},"/api/v1/plugins/{plugin_id}":{"get":{"tags":["plugins"],"summary":"Get plugin details and configuration schema","description":"Returns full plugin details including configuration schema (JSON Schema format). Used by Streamlit admin UI to dynamically generate configuration forms (AC #5).","operationId":"get_plugin_details_api_v1_plugins__plugin_id__get","parameters":[{"name":"plugin_id","in":"path","required":true,"schema":{"type":"string","title":"Plugin Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PluginDetailsResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/plugins/{plugin_id}/test":{"post":{"tags":["plugins"],"summary":"Test plugin connection","description":"Validates plugin configuration by testing connection to ticketing tool API. Calls plugin.test_connection() method with provided config. Timeout: 30 seconds (AC #6).","operationId":"test_plugin_connection_api_v1_plugins__plugin_id__test_post","parameters":[{"name":"plugin_id","in":"path","required":true,"schema":{"type":"string","title":"Plugin Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConnectionTestRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ConnectionTestResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/prompt-templates":{"get":{"tags":["prompts"],"summary":"List Prompt Templates","description":"Retrieves available prompt templates. Returns built-in templates for all tenants and custom templates for current tenant.","operationId":"list_prompt_templates_api_agents_prompt_templates_get","parameters":[{"name":"include_builtin","in":"query","required":false,"schema":{"type":"boolean","default":true,"title":"Include Builtin"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PromptTemplateResponse"},"title":"Response List Prompt Templates Api Agents Prompt Templates Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"post":{"tags":["prompts"],"summary":"Create Custom Prompt Template","description":"Creates a new custom prompt template for the current tenant.","operationId":"create_prompt_template_api_agents_prompt_templates_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptTemplateCreate"},"examples":{"ticket_enhancement":{"summary":"Ticket Enhancement Template","description":"Template for ticket analysis agents","value":{"name":"Ticket Enhancement","description":"Template for analyzing and enriching support tickets","template_text":"You are a support ticket analyzer. Analyze the provided ticket and enrich it with: 1. Root cause analysis\n2. Related knowledge base articles\n3. IP address insights\nTenant: {{tenant_name}}\nAvailable Tools: {{tools}}\nCurrent Date: {{current_date}}"}},"rca_template":{"summary":"RCA Analysis Template","description":"Template for root cause analysis","value":{"name":"Root Cause Analysis","description":"Systematic RCA template using 5 Whys method","template_text":"Agent: {{agent_name}}\nUse the 5 Whys method to analyze incidents:\n1. Why did the issue occur?\n2. Why did that happen?\n[Continue asking why 3 more times]\nTools available: {{tools}}"}}}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptTemplateResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/prompt-templates/{template_id}":{"put":{"tags":["prompts"],"summary":"Update Custom Prompt Template","description":"Updates an existing custom prompt template. Built-in templates are read-only.","operationId":"update_prompt_template_api_agents_prompt_templates__template_id__put","parameters":[{"name":"template_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Template Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptTemplateCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptTemplateResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["prompts"],"summary":"Delete Custom Prompt Template","description":"Soft-deletes a custom template (marks as inactive). Built-in templates cannot be deleted.","operationId":"delete_prompt_template_api_agents_prompt_templates__template_id__delete","parameters":[{"name":"template_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Template Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Delete Prompt Template Api Agents Prompt Templates  Template Id  Delete"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/prompt-test":{"post":{"tags":["prompts"],"summary":"Test System Prompt with LLM","description":"Tests a system prompt by sending a sample message to the LLM through the LiteLLM proxy.","operationId":"test_prompt_api_agents_prompt_test_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptTestRequest"},"examples":{"basic_test":{"summary":"Test prompt with sample input","description":"Test a ticket enhancement prompt","value":{"system_prompt":"You are a support ticket analyzer. Analyze tickets and provide recommendations.","user_message":"Ticket: TKT-001\nCustomer: John Doe\nIssue: Password reset not working\nPriority: High","model":"gpt-4","temperature":0.7,"max_tokens":1000}}}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptTestResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/prompt-versions":{"get":{"tags":["prompts"],"summary":"Get Prompt Version History","description":"Retrieves version history for an agent's system prompt. Includes metadata for each version but not the full prompt text.","operationId":"get_prompt_versions_api_agents__agent_id__prompt_versions_get","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"default":20,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","minimum":0,"default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/PromptVersionResponse"},"title":"Response Get Prompt Versions Api Agents  Agent Id  Prompt Versions Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/prompt-versions/{version_id}":{"get":{"tags":["prompts"],"summary":"Get Prompt Version Detail","description":"Retrieves full prompt text for a specific version.","operationId":"get_prompt_version_detail_api_agents__agent_id__prompt_versions__version_id__get","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}},{"name":"version_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Version Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/PromptVersionDetail"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/prompt-versions/revert":{"post":{"tags":["prompts"],"summary":"Revert to Previous Prompt Version","description":"Reverts agent's system prompt to a previous version.","operationId":"revert_prompt_version_api_agents__agent_id__prompt_versions_revert_post","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}}],"requestBody":{"content":{"application/json":{"schema":{"type":"object","additionalProperties":{"type":"string"},"default":{},"title":"Request Body"},"examples":{"revert_example":{"summary":"Revert to previous version","description":"Revert to version created 1 day ago","value":{"version_id":"550e8400-e29b-41d4-a716-446655440000"}}}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Revert Prompt Version Api Agents  Agent Id  Prompt Versions Revert Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/openapi-tools/parse":{"post":{"tags":["openapi-tools"],"summary":"Parse Spec","description":"Parse and validate OpenAPI spec, extract metadata.","operationId":"parse_spec_api_openapi_tools_parse_post","requestBody":{"content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Request"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Parse Spec Api Openapi Tools Parse Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/openapi-tools/test-connection":{"post":{"tags":["openapi-tools"],"summary":"Test Connection","description":"Test API connection with provided credentials.","operationId":"test_connection_api_openapi_tools_test_connection_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TestConnectionRequest"}}},"required":true},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TestConnectionResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/openapi-tools":{"post":{"tags":["openapi-tools"],"summary":"Create Tool","description":"Create new OpenAPI tool.","operationId":"create_tool_api_openapi_tools_post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/OpenAPIToolCreate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Create Tool Api Openapi Tools Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["openapi-tools"],"summary":"List Tools","description":"List all tools for tenant.","operationId":"list_tools_api_openapi_tools_get","parameters":[{"name":"tenant_id","in":"query","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Status"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/OpenAPITool"},"title":"Response List Tools Api Openapi Tools Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/openapi-tools/{tool_id}":{"get":{"tags":["openapi-tools"],"summary":"Get Tool","description":"Get tool by ID.","operationId":"get_tool_api_openapi_tools__tool_id__get","parameters":[{"name":"tool_id","in":"path","required":true,"schema":{"type":"integer","title":"Tool Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/OpenAPITool"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/":{"post":{"tags":["agents"],"summary":"Create Agent","description":"Creates a new agent with webhook trigger and optional tool assignments. Agent defaults to DRAFT status and must be activated before use. Webhook URL and HMAC secret are auto-generated.","operationId":"create_agent_api_agents__post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentCreate"},"examples":{"ticket_enhancement":{"summary":"Ticket Enhancement Agent","description":"Agent for enriching support tickets with context","value":{"name":"Ticket Enhancement Agent","description":"Automatically enriches support tickets with context","system_prompt":"You are a helpful assistant that enriches support tickets with relevant context from history, knowledge base, and IP information.","llm_config":{"provider":"litellm","model":"gpt-4","temperature":0.7,"max_tokens":4096},"status":"draft","created_by":"admin@example.com","tool_ids":["servicedesk_plus"]}},"rca_agent":{"summary":"Root Cause Analysis Agent","description":"Agent for performing RCA on incidents","value":{"name":"RCA Agent","description":"Performs root cause analysis on incidents","system_prompt":"You are an expert in root cause analysis. Analyze incidents systematically using the 5 Whys method.","llm_config":{"provider":"litellm","model":"claude-3-5-sonnet","temperature":0.5,"max_tokens":8192},"status":"draft","tool_ids":["servicedesk_plus"]}}}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"get":{"tags":["agents"],"summary":"List Agents","description":"Get paginated list of agents with optional filtering by status or name search. Returns only agents belonging to the current tenant.","operationId":"list_agents_api_agents__get","parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","minimum":0,"description":"Number of agents to skip (pagination offset)","default":0,"title":"Skip"},"description":"Number of agents to skip (pagination offset)"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"Maximum agents to return (1-100)","default":20,"title":"Limit"},"description":"Maximum agents to return (1-100)"},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Filter by agent status - supports comma-separated values (draft, active, suspended, inactive)","title":"Status"},"description":"Filter by agent status - supports comma-separated values (draft, active, suspended, inactive)"},{"name":"q","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Search agents by name (case-insensitive partial match)","title":"Q"},"description":"Search agents by name (case-insensitive partial match)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response List Agents Api Agents  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/tool-usage-stats":{"get":{"tags":["agents"],"summary":"Get Tool Usage Statistics","description":"Get count of agents using each tool for UI display.","operationId":"get_tool_usage_stats_api_agents_tool_usage_stats_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Get Tool Usage Stats Api Agents Tool Usage Stats Get"}}}}}}},"/api/agents/{agent_id}":{"get":{"tags":["agents"],"summary":"Get Agent","description":"Get full agent details including assigned tools and triggers.","operationId":"get_agent_api_agents__agent_id__get","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["agents"],"summary":"Update Agent","description":"Update agent properties with partial data support. Status transitions are validated (e.g., cannot change active→draft).","operationId":"update_agent_api_agents__agent_id__put","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentUpdate"},"examples":{"name_only":{"summary":"Update name only","value":{"name":"Updated Agent Name"}},"system_prompt":{"summary":"Update system prompt","value":{"system_prompt":"Updated system prompt with new instructions"}},"suspend_agent":{"summary":"Suspend agent","value":{"status":"suspended"}}}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["agents"],"summary":"Delete Agent","description":"Soft delete agent (sets status=inactive). Agent record is preserved for audit trail.","operationId":"delete_agent_api_agents__agent_id__delete","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}}],"responses":{"204":{"description":"Successful Response"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/activate":{"post":{"tags":["agents"],"summary":"Activate Agent","description":"Activate agent: transition from DRAFT→ACTIVE with validation. Agent must have system_prompt, llm_config with model, and at least one trigger.","operationId":"activate_agent_api_agents__agent_id__activate_post","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/webhook-secret":{"get":{"tags":["agents"],"summary":"Get Webhook Secret","description":"Fetch unmasked HMAC secret for agent. Rate-limited to 10 req/min. Audit logged.","operationId":"get_webhook_secret_api_agents__agent_id__webhook_secret_get","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Webhook Secret Api Agents  Agent Id  Webhook Secret Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/regenerate-webhook-secret":{"post":{"tags":["agents"],"summary":"Regenerate Webhook Secret","description":"Generate new HMAC secret, invalidate old webhooks. Audit logged.","operationId":"regenerate_webhook_secret_api_agents__agent_id__regenerate_webhook_secret_post","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Regenerate Webhook Secret Api Agents  Agent Id  Regenerate Webhook Secret Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/budget-alerts":{"post":{"tags":["budget"],"summary":"Receive LiteLLM budget alert webhooks","description":"Webhook endpoint for LiteLLM proxy budget alerts. Receives alerts when tenants cross budget thresholds (80%, 100%, projected). Handles async notification dispatch and audit logging. Returns 200 OK immediately to avoid LiteLLM retry storms.","operationId":"receive_budget_alert_api_v1_budget_alerts_post","parameters":[{"name":"X-Webhook-Signature","in":"header","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"X-Webhook-Signature"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BudgetWebhookPayload"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Receive Budget Alert Api V1 Budget Alerts Post"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/llm-providers":{"get":{"tags":["llm-providers"],"summary":"[DEPRECATED] List LLM providers","description":"DEPRECATED: Use LiteLLM API instead. Returns HTTP 410 Gone.","operationId":"list_providers_deprecated_api_llm_providers_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}},"post":{"tags":["llm-providers"],"summary":"[DEPRECATED] Create LLM provider","description":"DEPRECATED: Use LiteLLM API instead. Returns HTTP 410 Gone.","operationId":"create_provider_deprecated_api_llm_providers_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/llm-providers/{provider_id}":{"get":{"tags":["llm-providers"],"summary":"[DEPRECATED] Get LLM provider details","description":"DEPRECATED: Use LiteLLM API instead. Returns HTTP 410 Gone.","operationId":"get_provider_deprecated_api_llm_providers__provider_id__get","parameters":[{"name":"provider_id","in":"path","required":true,"schema":{"type":"integer","title":"Provider Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["llm-providers"],"summary":"[DEPRECATED] Update LLM provider","description":"DEPRECATED: Use LiteLLM API instead. Returns HTTP 410 Gone.","operationId":"update_provider_deprecated_api_llm_providers__provider_id__put","parameters":[{"name":"provider_id","in":"path","required":true,"schema":{"type":"integer","title":"Provider Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["llm-providers"],"summary":"[DEPRECATED] Delete LLM provider","description":"DEPRECATED: Use LiteLLM API instead. Returns HTTP 410 Gone.","operationId":"delete_provider_deprecated_api_llm_providers__provider_id__delete","parameters":[{"name":"provider_id","in":"path","required":true,"schema":{"type":"integer","title":"Provider Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/llm-providers/{provider_id}/test-connection":{"post":{"tags":["llm-providers"],"summary":"[DEPRECATED] Test provider connection","description":"DEPRECATED: Use LiteLLM API instead. Returns HTTP 410 Gone.","operationId":"test_connection_deprecated_api_llm_providers__provider_id__test_connection_post","parameters":[{"name":"provider_id","in":"path","required":true,"schema":{"type":"integer","title":"Provider Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/llm-providers/{provider_id}/models":{"get":{"tags":["llm-providers"],"summary":"[DEPRECATED] Get provider models","description":"DEPRECATED: Use LiteLLM API instead. Returns HTTP 410 Gone.","operationId":"get_models_deprecated_api_llm_providers__provider_id__models_get","parameters":[{"name":"provider_id","in":"path","required":true,"schema":{"type":"integer","title":"Provider Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/llm-providers/{provider_id}/sync-models":{"post":{"tags":["llm-providers"],"summary":"[DEPRECATED] Sync provider models","description":"DEPRECATED: Use LiteLLM API instead. Returns HTTP 410 Gone.","operationId":"sync_models_deprecated_api_llm_providers__provider_id__sync_models_post","parameters":[{"name":"provider_id","in":"path","required":true,"schema":{"type":"integer","title":"Provider Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/llm-models/available":{"get":{"tags":["llm-models"],"summary":"Get available models from LiteLLM","description":"Returns list of currently available LLM models from the LiteLLM proxy. Results are cached for 5 minutes. No authentication required (public endpoint).","operationId":"get_available_models_api_llm_models_available_get","parameters":[{"name":"force_refresh","in":"query","required":false,"schema":{"type":"boolean","description":"Skip cache and fetch fresh from LiteLLM","default":false,"title":"Force Refresh"},"description":"Skip cache and fetch fresh from LiteLLM"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ModelInfo"},"title":"Response Get Available Models Api Llm Models Available Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/llm-models":{"post":{"tags":["llm-models"],"summary":"[DEPRECATED] Create new LLM model","description":"DEPRECATED: Use LiteLLM API instead. Returns HTTP 410 Gone.","operationId":"create_model_deprecated_api_llm_models_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/llm-models/{model_id}":{"get":{"tags":["llm-models"],"summary":"[DEPRECATED] Get LLM model details","description":"DEPRECATED: Use LiteLLM API instead. Returns HTTP 410 Gone.","operationId":"get_model_deprecated_api_llm_models__model_id__get","parameters":[{"name":"model_id","in":"path","required":true,"schema":{"type":"integer","title":"Model Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["llm-models"],"summary":"[DEPRECATED] Update LLM model configuration","description":"DEPRECATED: Use LiteLLM API instead. Returns HTTP 410 Gone.","operationId":"update_model_deprecated_api_llm_models__model_id__put","parameters":[{"name":"model_id","in":"path","required":true,"schema":{"type":"integer","title":"Model Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["llm-models"],"summary":"[DEPRECATED] Delete LLM model","description":"DEPRECATED: Use LiteLLM API instead. Returns HTTP 410 Gone.","operationId":"delete_model_deprecated_api_llm_models__model_id__delete","parameters":[{"name":"model_id","in":"path","required":true,"schema":{"type":"integer","title":"Model Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/llm-models/{model_id}/toggle":{"post":{"tags":["llm-models"],"summary":"[DEPRECATED] Toggle LLM model enabled status","description":"DEPRECATED: Use LiteLLM API instead. Returns HTTP 410 Gone.","operationId":"toggle_model_deprecated_api_llm_models__model_id__toggle_post","parameters":[{"name":"model_id","in":"path","required":true,"schema":{"type":"integer","title":"Model Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/llm-models/bulk-enable":{"post":{"tags":["llm-models"],"summary":"[DEPRECATED] Bulk enable LLM models","description":"DEPRECATED: Use LiteLLM API instead. Returns HTTP 410 Gone.","operationId":"bulk_enable_models_deprecated_api_llm_models_bulk_enable_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/llm-models/bulk-disable":{"post":{"tags":["llm-models"],"summary":"[DEPRECATED] Bulk disable LLM models","description":"DEPRECATED: Use LiteLLM API instead. Returns HTTP 410 Gone.","operationId":"bulk_disable_models_deprecated_api_llm_models_bulk_disable_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}}}}},"/api/fallback-chains":{"get":{"tags":["fallback-chains"],"summary":"[DEPRECATED] List fallback chains","description":"DEPRECATED: Returns HTTP 410 Gone. Use LiteLLM fallback mechanisms.","operationId":"list_fallback_chains_deprecated_api_fallback_chains_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"404":{"description":"Not found"}}},"post":{"tags":["fallback-chains"],"summary":"[DEPRECATED] Create fallback chain","description":"DEPRECATED: Returns HTTP 410 Gone. Use LiteLLM fallback mechanisms.","operationId":"create_fallback_chain_deprecated_api_fallback_chains_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"404":{"description":"Not found"}}}},"/api/fallback-chains/{chain_id}":{"get":{"tags":["fallback-chains"],"summary":"[DEPRECATED] Get fallback chain details","description":"DEPRECATED: Returns HTTP 410 Gone. Use LiteLLM fallback mechanisms.","operationId":"get_fallback_chain_deprecated_api_fallback_chains__chain_id__get","parameters":[{"name":"chain_id","in":"path","required":true,"schema":{"type":"integer","title":"Chain Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["fallback-chains"],"summary":"[DEPRECATED] Update fallback chain","description":"DEPRECATED: Returns HTTP 410 Gone. Use LiteLLM fallback mechanisms.","operationId":"update_fallback_chain_deprecated_api_fallback_chains__chain_id__put","parameters":[{"name":"chain_id","in":"path","required":true,"schema":{"type":"integer","title":"Chain Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"delete":{"tags":["fallback-chains"],"summary":"[DEPRECATED] Delete fallback chain","description":"DEPRECATED: Returns HTTP 410 Gone. Use LiteLLM fallback mechanisms.","operationId":"delete_fallback_chain_deprecated_api_fallback_chains__chain_id__delete","parameters":[{"name":"chain_id","in":"path","required":true,"schema":{"type":"integer","title":"Chain Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/fallback-chains/{chain_id}/toggle":{"post":{"tags":["fallback-chains"],"summary":"[DEPRECATED] Toggle fallback chain","description":"DEPRECATED: Returns HTTP 410 Gone. Use LiteLLM fallback mechanisms.","operationId":"toggle_fallback_chain_deprecated_api_fallback_chains__chain_id__toggle_post","parameters":[{"name":"chain_id","in":"path","required":true,"schema":{"type":"integer","title":"Chain Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/fallback-chains/model/{model_id}":{"get":{"tags":["fallback-chains"],"summary":"[DEPRECATED] Get fallback chains by model","description":"DEPRECATED: Returns HTTP 410 Gone. Use LiteLLM fallback mechanisms.","operationId":"get_fallback_chains_by_model_deprecated_api_fallback_chains_model__model_id__get","parameters":[{"name":"model_id","in":"path","required":true,"schema":{"type":"integer","title":"Model Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"404":{"description":"Not found"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/fallback-chains/metrics":{"get":{"tags":["fallback-chains"],"summary":"[DEPRECATED] Get fallback metrics","description":"DEPRECATED: Returns HTTP 410 Gone. Use LiteLLM fallback mechanisms.","operationId":"get_fallback_metrics_deprecated_api_fallback_chains_metrics_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"404":{"description":"Not found"}}}},"/api/fallback-chains/test":{"post":{"tags":["fallback-chains"],"summary":"[DEPRECATED] Test fallback chain","description":"DEPRECATED: Returns HTTP 410 Gone. Use LiteLLM fallback mechanisms.","operationId":"test_fallback_chain_deprecated_api_fallback_chains_test_post","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{}}}},"404":{"description":"Not found"}}}},"/api/tenants/{tenant_id}/byok/test-keys":{"post":{"tags":["BYOK"],"summary":"Test Provider API Keys","description":"Validate OpenAI and Anthropic API keys before enabling BYOK (AC#3)","operationId":"test_keys_api_tenants__tenant_id__byok_test_keys_post","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"X-Admin-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BYOKTestKeysRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BYOKTestKeysResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tenants/{tenant_id}/byok/enable":{"post":{"tags":["BYOK"],"summary":"Enable BYOK Mode","description":"Enable BYOK with validation, encryption, and virtual key creation (AC#1-4)","operationId":"enable_byok_api_tenants__tenant_id__byok_enable_post","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"X-Admin-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BYOKEnableRequest"}}}},"responses":{"201":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BYOKEnableResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tenants/{tenant_id}/byok/rotate-keys":{"put":{"tags":["BYOK"],"summary":"Rotate BYOK Keys","description":"Rotate BYOK tenant's provider API keys and virtual key (AC#7)","operationId":"rotate_keys_api_tenants__tenant_id__byok_rotate_keys_put","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"X-Admin-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Key"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BYOKRotateKeysRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BYOKRotateKeysResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tenants/{tenant_id}/byok/disable":{"post":{"tags":["BYOK"],"summary":"Disable BYOK and Revert to Platform Keys","description":"Disable BYOK mode and revert tenant to platform keys (AC#8)","operationId":"disable_byok_api_tenants__tenant_id__byok_disable_post","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"X-Admin-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BYOKDisableResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tenants/{tenant_id}/byok/status":{"get":{"tags":["BYOK"],"summary":"Get BYOK Status","description":"Get BYOK status and configuration for tenant (AC#6)","operationId":"get_byok_status_api_tenants__tenant_id__byok_status_get","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}},{"name":"X-Admin-Key","in":"header","required":false,"schema":{"type":"string","title":"X-Admin-Key"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BYOKStatusResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/test":{"post":{"tags":["agent-testing"],"summary":"Execute Agent Test","description":"Execute agent test in sandbox mode. Returns execution trace, token usage, and timing breakdown.","operationId":"execute_agent_test_api_agents__agent_id__test_post","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentTestRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentTestResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/test-history":{"get":{"tags":["agent-testing"],"summary":"Get Test History","description":"Retrieve paginated test execution history for an agent.","operationId":"get_test_history_api_agents__agent_id__test_history_get","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":500,"minimum":1,"default":50,"title":"Limit"}},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","minimum":0,"default":0,"title":"Offset"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Test History Api Agents  Agent Id  Test History Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/test/{test_id}":{"get":{"tags":["agent-testing"],"summary":"Get Test Result","description":"Retrieve a single test execution result.","operationId":"get_test_result_api_agents__agent_id__test__test_id__get","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}},{"name":"test_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Test Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Test Result Api Agents  Agent Id  Test  Test Id  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/test/compare":{"post":{"tags":["agent-testing"],"summary":"Compare Tests","description":"Compare two test execution results to identify differences.","operationId":"compare_tests_api_agents__agent_id__test_compare_post","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/TestComparisonRequest"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TestComparisonResult"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/memory/config":{"get":{"tags":["memory"],"summary":"Get agent memory configuration","description":"Retrieve current memory configuration for specified agent with tenant isolation.","operationId":"get_memory_config_api_agents__agent_id__memory_config_get","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemoryConfigResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"put":{"tags":["memory"],"summary":"Update agent memory configuration","description":"Update memory settings with validation and tenant isolation.","operationId":"update_memory_config_api_agents__agent_id__memory_config_put","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemoryConfigUpdate"}}}},"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemoryConfigResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/memory/state":{"get":{"tags":["memory"],"summary":"Get agent memory state","description":"Retrieve complete memory state including configuration and recent memories.","operationId":"get_memory_state_api_agents__agent_id__memory_state_get","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}},{"name":"limit_per_type","in":"query","required":false,"schema":{"type":"integer","maximum":50,"minimum":1,"description":"Max memories to return per type","default":10,"title":"Limit Per Type"},"description":"Max memories to return per type"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemoryState"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/memory":{"delete":{"tags":["memory"],"summary":"Clear agent memory","description":"Delete agent memories with optional type filter (None = clear all types).","operationId":"clear_memory_api_agents__agent_id__memory_delete","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}},{"name":"memory_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string","pattern":"^(short_term|long_term|agentic)?$"},{"type":"null"}],"description":"Memory type to clear (omit to clear all types)","title":"Memory Type"},"description":"Memory type to clear (omit to clear all types)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemoryClearResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/memory/history":{"get":{"tags":["memory"],"summary":"Get agent memory history","description":"Retrieve paginated memory items with optional type filter.","operationId":"get_memory_history_api_agents__agent_id__memory_history_get","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}},{"name":"memory_type","in":"query","required":false,"schema":{"anyOf":[{"type":"string","pattern":"^(short_term|long_term|agentic)?$"},{"type":"null"}],"description":"Filter by memory type","title":"Memory Type"},"description":"Filter by memory type"},{"name":"page","in":"query","required":false,"schema":{"type":"integer","minimum":1,"description":"Page number (1-indexed)","default":1,"title":"Page"},"description":"Page number (1-indexed)"},{"name":"page_size","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"Items per page","default":20,"title":"Page Size"},"description":"Items per page"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MemoryHistoryResponse"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/costs/summary":{"get":{"tags":["LLM Costs"],"summary":"Get Cost Summary","description":"Get overall cost summary (AC#2).\n\nReturns:\n- Today's spend\n- This week's spend\n- This month's spend\n- Last 30 days total\n- Top tenant by spend (if admin)\n- Top agent by spend\n\n**Tenant Isolation**: Filters by authenticated tenant","operationId":"get_cost_summary_api_costs_summary_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"$ref":"#/components/schemas/CostSummaryDTO"}}}}}}},"/api/costs/by-tenant":{"get":{"tags":["LLM Costs"],"summary":"Get Spend By Tenant","description":"Get top N tenants by spend (AC#2).\n\n**Admin Only**: Returns all tenants. Non-admin users see only their tenant.\n\n**Tenant Isolation**: Enforced via get_tenant_id()","operationId":"get_spend_by_tenant_api_costs_by_tenant_get","parameters":[{"name":"start_date","in":"query","required":true,"schema":{"type":"string","format":"date","description":"Start date (YYYY-MM-DD)","title":"Start Date"},"description":"Start date (YYYY-MM-DD)"},{"name":"end_date","in":"query","required":true,"schema":{"type":"string","format":"date","description":"End date (YYYY-MM-DD)","title":"End Date"},"description":"End date (YYYY-MM-DD)"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"Max results","default":10,"title":"Limit"},"description":"Max results"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TenantSpendDTO"},"title":"Response Get Spend By Tenant Api Costs By Tenant Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/costs/by-agent":{"get":{"tags":["LLM Costs"],"summary":"Get Spend By Agent","description":"Get top N agents by spend with execution statistics (AC#6).\n\nReturns:\n- Agent name\n- Execution count\n- Total cost\n- Average cost per execution\n\n**Tenant Isolation**: Filters by authenticated tenant","operationId":"get_spend_by_agent_api_costs_by_agent_get","parameters":[{"name":"start_date","in":"query","required":true,"schema":{"type":"string","format":"date","description":"Start date (YYYY-MM-DD)","title":"Start Date"},"description":"Start date (YYYY-MM-DD)"},{"name":"end_date","in":"query","required":true,"schema":{"type":"string","format":"date","description":"End date (YYYY-MM-DD)","title":"End Date"},"description":"End date (YYYY-MM-DD)"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"Max results","default":10,"title":"Limit"},"description":"Max results"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/AgentSpendDTO"},"title":"Response Get Spend By Agent Api Costs By Agent Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/costs/by-model":{"get":{"tags":["LLM Costs"],"summary":"Get Spend By Model","description":"Get spend breakdown by model (AC#2).\n\nReturns:\n- Model name\n- Total spend\n- Total tokens\n- Prompt tokens\n- Completion tokens\n\n**Tenant Isolation**: Filters by authenticated tenant","operationId":"get_spend_by_model_api_costs_by_model_get","parameters":[{"name":"start_date","in":"query","required":true,"schema":{"type":"string","format":"date","description":"Start date (YYYY-MM-DD)","title":"Start Date"},"description":"Start date (YYYY-MM-DD)"},{"name":"end_date","in":"query","required":true,"schema":{"type":"string","format":"date","description":"End date (YYYY-MM-DD)","title":"End Date"},"description":"End date (YYYY-MM-DD)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/ModelSpendDTO"},"title":"Response Get Spend By Model Api Costs By Model Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/costs/token-breakdown":{"get":{"tags":["LLM Costs"],"summary":"Get Token Breakdown","description":"Get token usage breakdown (input vs output) by model (AC#4).\n\nReturns:\n- Model name\n- Prompt tokens\n- Completion tokens\n- Total tokens\n- Percentages\n\n**Tenant Isolation**: Filters by authenticated tenant","operationId":"get_token_breakdown_api_costs_token_breakdown_get","parameters":[{"name":"start_date","in":"query","required":true,"schema":{"type":"string","format":"date","description":"Start date (YYYY-MM-DD)","title":"Start Date"},"description":"Start date (YYYY-MM-DD)"},{"name":"end_date","in":"query","required":true,"schema":{"type":"string","format":"date","description":"End date (YYYY-MM-DD)","title":"End Date"},"description":"End date (YYYY-MM-DD)"},{"name":"model","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"Optional model filter","title":"Model"},"description":"Optional model filter"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/TokenBreakdownDTO"},"title":"Response Get Token Breakdown Api Costs Token Breakdown Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/costs/trend":{"get":{"tags":["LLM Costs"],"summary":"Get Daily Spend Trend","description":"Get daily spend trend time series (AC#3).\n\nReturns daily aggregations for the last N days.\nMissing dates filled with $0.00.\n\n**Tenant Isolation**: Filters by authenticated tenant","operationId":"get_daily_spend_trend_api_costs_trend_get","parameters":[{"name":"days","in":"query","required":false,"schema":{"type":"integer","maximum":365,"minimum":1,"description":"Number of days","default":30,"title":"Days"},"description":"Number of days"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/DailySpendDTO"},"title":"Response Get Daily Spend Trend Api Costs Trend Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/costs/budget-utilization":{"get":{"tags":["LLM Costs"],"summary":"Get Budget Utilization","description":"Get budget utilization for tenants (AC#5).\n\nReturns:\n- Budget limit\n- Current spend (this month)\n- Remaining budget\n- Utilization percentage\n- Color indicator (green/yellow/red)\n\n**Tenant Isolation**: Returns only authenticated tenant's data","operationId":"get_budget_utilization_api_costs_budget_utilization_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/BudgetUtilizationDTO"},"type":"array","title":"Response Get Budget Utilization Api Costs Budget Utilization Get"}}}}}}},"/api/agents/{agent_id}/metrics":{"get":{"tags":["agent-performance"],"summary":"Get Agent Metrics","description":"Get per-agent performance metrics.\n\nReturns: execution count, success rate, latency percentiles.\nRequires tenant isolation.","operationId":"get_agent_metrics_api_agents__agent_id__metrics_get","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}},{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"description":"Start date (YYYY-MM-DD)","title":"Start Date"},"description":"Start date (YYYY-MM-DD)"},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"description":"End date (YYYY-MM-DD)","title":"End Date"},"description":"End date (YYYY-MM-DD)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Agent Metrics Api Agents  Agent Id  Metrics Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/history":{"get":{"tags":["agent-performance"],"summary":"Get Execution History","description":"Get paginated execution history with filtering.\n\nSupports status, date range, and pagination filters.","operationId":"get_execution_history_api_agents__agent_id__history_get","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"type":"string"},{"type":"null"}],"description":"success or failed","title":"Status"},"description":"success or failed"},{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"description":"Start date (YYYY-MM-DD)","title":"Start Date"},"description":"Start date (YYYY-MM-DD)"},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"description":"End date (YYYY-MM-DD)","title":"End Date"},"description":"End date (YYYY-MM-DD)"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":500,"minimum":1,"description":"Results per page","default":50,"title":"Limit"},"description":"Results per page"},{"name":"offset","in":"query","required":false,"schema":{"type":"integer","minimum":0,"description":"Pagination offset","default":0,"title":"Offset"},"description":"Pagination offset"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Execution History Api Agents  Agent Id  History Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/trends":{"get":{"tags":["agent-performance"],"summary":"Get Performance Trends","description":"Get performance trends for charting (execution count and duration over time).\n\nDefault: last 7 days.","operationId":"get_performance_trends_api_agents__agent_id__trends_get","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}},{"name":"days","in":"query","required":false,"schema":{"type":"integer","maximum":90,"minimum":1,"description":"Number of days","default":7,"title":"Days"},"description":"Number of days"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Performance Trends Api Agents  Agent Id  Trends Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/{agent_id}/error-analysis":{"get":{"tags":["agent-performance"],"summary":"Get Error Analysis","description":"Get error type breakdown for pie chart.\n\nCategorizes errors by type: timeout, rate_limit, validation_error, tool_failure, other.","operationId":"get_error_analysis_api_agents__agent_id__error_analysis_get","parameters":[{"name":"agent_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Agent Id"}},{"name":"start_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"description":"Start date (YYYY-MM-DD)","title":"Start Date"},"description":"Start date (YYYY-MM-DD)"},{"name":"end_date","in":"query","required":false,"schema":{"anyOf":[{"type":"string","format":"date"},{"type":"null"}],"description":"End date (YYYY-MM-DD)","title":"End Date"},"description":"End date (YYYY-MM-DD)"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Error Analysis Api Agents  Agent Id  Error Analysis Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agents/slowest":{"get":{"tags":["agent-performance"],"summary":"Get Slowest Agents","description":"Get slowest agents sorted by P95 latency.\n\nUseful for identifying optimization candidates.\nTenant-isolated.","operationId":"get_slowest_agents_api_agents_slowest_get","parameters":[{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":100,"minimum":1,"description":"Max agents to return","default":10,"title":"Limit"},"description":"Max agents to return"}],"responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Get Slowest Agents Api Agents Slowest Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/tenants/{tenant_id}/spend":{"get":{"tags":["tenant-spend"],"summary":"Get tenant spend data","description":"Retrieve real-time spend data for a tenant from LiteLLM virtual key. Includes budget utilization percentage and per-model spend breakdown. Used by admin dashboard to display cost visibility.","operationId":"get_tenant_spend_api_tenants__tenant_id__spend_get","parameters":[{"name":"tenant_id","in":"path","required":true,"schema":{"type":"string","title":"Tenant Id"}}],"responses":{"200":{"description":"Real-time spend data retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/TenantSpendResponse"}}}},"404":{"description":"Tenant not found or has no virtual key configured"},"503":{"description":"LiteLLM proxy service unavailable"},"500":{"description":"Internal server error"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/executions/{execution_id}":{"get":{"tags":["executions"],"summary":"Get Execution Details","description":"Retrieve full execution details including trace, tokens, and timing for a specific execution ID.","operationId":"get_execution_details_api_executions__execution_id__get","parameters":[{"name":"execution_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Execution Id"}}],"responses":{"200":{"description":"Execution details retrieved successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ExecutionDetailResponse"}}}},"403":{"description":"Forbidden: Execution belongs to a different tenant","content":{"application/json":{"example":{"detail":"Forbidden: Access denied"}}}},"404":{"description":"Execution not found","content":{"application/json":{"example":{"detail":"Execution not found"}}}},"500":{"description":"Internal server error","content":{"application/json":{"example":{"detail":"Failed to retrieve execution"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/mcp-servers/":{"post":{"tags":["MCP Servers"],"summary":"Create MCP Server","description":"Creates a new MCP server and triggers automatic capability discovery. Discovery runs initialize → list_tools → list_resources → list_prompts. Returns server with status='active' if discovery succeeds, or status='error' if it fails.","operationId":"create_mcp_server_api_v1_mcp_servers__post","requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MCPServerCreate"},"examples":{"stdio_server":{"summary":"stdio Transport Server","description":"MCP server using stdio transport (subprocess)","value":{"name":"everything-server","description":"Example MCP server with all capabilities","transport_type":"stdio","command":"npx","args":["-y","@modelcontextprotocol/server-everything"],"env":{"LOG_LEVEL":"info"}}},"http_sse_server":{"summary":"HTTP/SSE Transport Server","description":"MCP server using HTTP with Server-Sent Events","value":{"name":"remote-server","description":"Remote MCP server via HTTP","transport_type":"http_sse","url":"https://example.com/mcp","headers":{"Authorization":"Bearer token123"}}}}}}},"responses":{"201":{"description":"MCP server created successfully with discovered capabilities","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MCPServerResponse"}}}},"422":{"description":"Validation error (missing required fields)"},"409":{"description":"Server name already exists for this tenant"}}},"get":{"tags":["MCP Servers"],"summary":"List MCP Servers","description":"Returns paginated list of MCP servers for authenticated tenant. Supports filtering by status and transport_type. Only servers belonging to the authenticated tenant are returned.","operationId":"list_mcp_servers_api_v1_mcp_servers__get","parameters":[{"name":"skip","in":"query","required":false,"schema":{"type":"integer","minimum":0,"description":"Pagination offset","default":0,"title":"Skip"},"description":"Pagination offset"},{"name":"limit","in":"query","required":false,"schema":{"type":"integer","maximum":1000,"minimum":1,"description":"Page size (max 1000)","default":100,"title":"Limit"},"description":"Page size (max 1000)"},{"name":"status","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/MCPServerStatus"},{"type":"null"}],"description":"Filter by status (active/inactive/error)","title":"Status"},"description":"Filter by status (active/inactive/error)"},{"name":"transport_type","in":"query","required":false,"schema":{"anyOf":[{"$ref":"#/components/schemas/TransportType"},{"type":"null"}],"description":"Filter by transport type (stdio/http_sse)","title":"Transport Type"},"description":"Filter by transport type (stdio/http_sse)"}],"responses":{"200":{"description":"List of MCP servers (may be empty)","content":{"application/json":{"schema":{"type":"array","items":{"$ref":"#/components/schemas/MCPServerResponse"},"title":"Response List Mcp Servers Api V1 Mcp Servers  Get"}}}},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/mcp-servers/{server_id}":{"get":{"tags":["MCP Servers"],"summary":"Get MCP Server Details","description":"Returns complete MCP server details including full discovered capabilities arrays. Returns 404 if server doesn't exist or belongs to different tenant.","operationId":"get_mcp_server_api_v1_mcp_servers__server_id__get","parameters":[{"name":"server_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Server Id"}}],"responses":{"200":{"description":"MCP server details with complete discovered capabilities","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MCPServerResponse"}}}},"404":{"description":"Server not found or not accessible by authenticated tenant"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}},"patch":{"tags":["MCP Servers"],"summary":"Update MCP Server","description":"Updates MCP server (partial update supported). Allows updating: name, description, command, args, env, url, headers. Does NOT allow updating: tenant_id, discovered_*, created_at, status.","operationId":"update_mcp_server_api_v1_mcp_servers__server_id__patch","parameters":[{"name":"server_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Server Id"}}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MCPServerUpdate"}}}},"responses":{"200":{"description":"MCP server updated successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MCPServerResponse"}}}},"404":{"description":"Server not found or not accessible by authenticated tenant"},"422":{"description":"Validation error (transport-specific constraints)"}}},"delete":{"tags":["MCP Servers"],"summary":"Delete MCP Server","description":"Deletes MCP server (hard delete). Returns 404 if server doesn't exist or belongs to different tenant.","operationId":"delete_mcp_server_api_v1_mcp_servers__server_id__delete","parameters":[{"name":"server_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Server Id"}}],"responses":{"204":{"description":"MCP server deleted successfully"},"404":{"description":"Server not found or not accessible by authenticated tenant"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/mcp-servers/{server_id}/discover":{"post":{"tags":["MCP Servers"],"summary":"Force Rediscovery","description":"Triggers manual capability rediscovery for MCP server. Runs complete discovery workflow: initialize → list_tools → list_resources → list_prompts. Updates discovered_tools, discovered_resources, discovered_prompts fields. Returns updated server with status='active' or 'error'.","operationId":"rediscover_mcp_server_api_v1_mcp_servers__server_id__discover_post","parameters":[{"name":"server_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Server Id"}}],"responses":{"200":{"description":"Discovery completed, server updated with results","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MCPServerResponse"}}}},"404":{"description":"Server not found or not accessible by authenticated tenant"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/mcp-servers/{server_id}/health":{"get":{"tags":["MCP Servers"],"summary":"Health Check","description":"Performs lightweight health check on MCP server (initialize only, no full discovery). Returns health status with response_time_ms. Timeout: 10 seconds (shorter than full discovery).","operationId":"check_mcp_server_health_api_v1_mcp_servers__server_id__health_get","parameters":[{"name":"server_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Server Id"}}],"responses":{"200":{"description":"Health check completed (check status field for result)","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Check Mcp Server Health Api V1 Mcp Servers  Server Id  Health Get"}}}},"404":{"description":"Server not found or not accessible by authenticated tenant"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/mcp-servers/{server_id}/health-check":{"post":{"tags":["MCP Servers"],"summary":"Perform Manual Health Check","description":"Immediately performs a health check on the specified MCP server (bypasses 30s interval). Updates database with results (status, last_health_check, consecutive_failures, error_message). Enforces tenant isolation - returns 403 if server belongs to different tenant. Story 11.1.8: Basic MCP Server Health Monitoring","operationId":"manual_health_check_api_v1_mcp_servers__server_id__health_check_post","parameters":[{"name":"server_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Server Id"}}],"responses":{"200":{"description":"Health check completed successfully","content":{"application/json":{"schema":{"type":"object","additionalProperties":true,"title":"Response Manual Health Check Api V1 Mcp Servers  Server Id  Health Check Post"}}}},"404":{"description":"Server not found"},"403":{"description":"Server belongs to different tenant"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/mcp-servers/{server_id}/metrics":{"get":{"tags":["MCP Servers"],"summary":"Get MCP Server Health Metrics","description":"Returns aggregated health metrics for MCP server over specified time period. Includes success/error rates, response time percentiles (P50/P95/P99), error distribution by type, uptime percentage, and 24h performance trend. Calculated from mcp_server_metrics time-series data with 7-day retention. Story 11.2.4: Enhanced MCP Health Monitoring (AC4)","operationId":"get_mcp_server_metrics_api_v1_mcp_servers__server_id__metrics_get","parameters":[{"name":"server_id","in":"path","required":true,"schema":{"type":"string","format":"uuid","title":"Server Id"}},{"name":"period_hours","in":"query","required":false,"schema":{"type":"integer","maximum":168,"minimum":1,"description":"Time period in hours to analyze (default 24, max 168 for 7 days)","default":24,"title":"Period Hours"},"description":"Time period in hours to analyze (default 24, max 168 for 7 days)"}],"responses":{"200":{"description":"Aggregated health metrics","content":{"application/json":{"schema":{"title":"Response Get Mcp Server Metrics Api V1 Mcp Servers  Server Id  Metrics Get"},"example":{"server_id":"550e8400-e29b-41d4-a716-446655440000","server_name":"filesystem-server","period_hours":24,"metrics":{"total_checks":2880,"success_rate":0.985,"error_rate":0.015,"avg_response_time_ms":125,"p50_response_time_ms":95,"p95_response_time_ms":280,"p99_response_time_ms":450,"max_response_time_ms":1200,"errors_by_type":{"TimeoutError":28,"ProcessCrashed":5,"InvalidJSON":10},"uptime_percentage":98.5,"last_24h_trend":"stable"}}}}},"404":{"description":"Server not found or not accessible by authenticated tenant"},"400":{"description":"Invalid query parameters"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/v1/mcp-servers/test-connection":{"post":{"tags":["MCP Servers"],"summary":"Test MCP Server Connection","description":"Tests MCP server configuration without saving to database. Performs full discovery workflow: initialize → list_tools → list_resources → list_prompts. Returns discovered capabilities on success (HTTP 200 with success=true), or error details on failure (HTTP 200 with success=false). Timeout: 30 seconds total. Story 11.2.2: HTTP+SSE Configuration in UI and API (AC4)","operationId":"test_mcp_server_connection_api_v1_mcp_servers_test_connection_post","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/MCPServerCreate"},"examples":{"stdio_test":{"summary":"Test stdio Server","description":"Test connection to stdio MCP server","value":{"name":"Test Filesystem Server","description":"Testing filesystem server","transport_type":"stdio","command":"npx","args":["-y","@modelcontextprotocol/server-filesystem","/tmp"],"env":{"LOG_LEVEL":"info"}}},"http_sse_test":{"summary":"Test HTTP+SSE Server","description":"Test connection to remote HTTP+SSE MCP server","value":{"name":"Test Remote Server","description":"Testing remote server","transport_type":"http_sse","url":"https://example.com/mcp","headers":{"Authorization":"Bearer test_token"}}}}}},"required":true},"responses":{"200":{"description":"Connection test completed (check success field)","content":{"application/json":{"schema":{"title":"Response Test Mcp Server Connection Api V1 Mcp Servers Test Connection Post"},"examples":{"success":{"summary":"Successful Connection","value":{"success":true,"server_info":{"protocol_version":"2025-03-26","server_name":"Example MCP Server","capabilities":["tools","resources","prompts"]},"discovered_tools":[{"name":"read_file","description":"Read file contents","inputSchema":{"type":"object","properties":{"path":{"type":"string"}},"required":["path"]}}],"discovered_resources":[{"uri":"file:///Users/ravi/config.json","name":"Config File","description":"Application configuration","mimeType":"application/json"}],"discovered_prompts":[]}},"failure":{"summary":"Connection Failed","value":{"success":false,"discovered_tools":[],"discovered_resources":[],"discovered_prompts":[],"error":"Connection timeout","error_details":"httpx.ConnectTimeout after 10 seconds"}}}}}},"422":{"description":"Validation error (missing required fields)"}}}},"/api/agent-execution/execute":{"post":{"tags":["agent-execution"],"summary":"Execute agent with user message","description":"Execute an agent with LangGraph ReAct workflow and MCP tool support.\n\n    Features:\n    - Multi-tenant execution with budget enforcement\n    - OpenAPI + MCP tool invocation\n    - Structured response with tool call history\n    - Graceful error handling\n\n    Authorization:\n    - Requires X-Tenant-ID header for tenant isolation\n\n    Budget Enforcement:\n    - Checks tenant budget before execution (Story 8.10)\n    - Returns 402 Payment Required if budget exceeded\n\n    Errors:\n    - 400 Bad Request: Invalid input (agent_id, timeout, etc.)\n    - 402 Payment Required: Budget exceeded\n    - 404 Not Found: Agent not found or belongs to different tenant\n    - 500 Internal Server Error: Execution failed","operationId":"execute_agent_api_agent_execution_execute_post","parameters":[{"name":"x-tenant-id","in":"header","required":true,"schema":{"type":"string","description":"Tenant identifier for isolation","title":"X-Tenant-Id"},"description":"Tenant identifier for isolation"}],"requestBody":{"required":true,"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentExecutionRequest"}}}},"responses":{"200":{"description":"Agent executed successfully","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentExecutionResponse"}}}},"400":{"description":"Invalid request parameters"},"402":{"description":"Budget exceeded","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BudgetExceededResponse"}}}},"404":{"description":"Agent not found or tenant mismatch"},"500":{"description":"Agent execution failed"},"422":{"description":"Validation Error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HTTPValidationError"}}}}}}},"/api/agent-execution/health":{"get":{"tags":["agent-execution"],"summary":"Health check for agent execution service","description":"Returns service health status and version info","operationId":"health_check_api_agent_execution_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":true,"type":"object","title":"Response Health Check Api Agent Execution Health Get"}}}}}}},"/api/v1/unified-tools/":{"get":{"tags":["unified-tools"],"summary":"List Unified Tools","description":"List all available tools for a tenant from all sources.\n\nQueries both OpenAPI tools and MCP servers, transforms them to unified format,\nhandles deduplication (OpenAPI tools take precedence), and returns cached\nresults when available.\n\nArgs:\n    tenant_id: Tenant ID from X-Tenant-ID header (extracted by dependency)\n    db: Database session with tenant context (provided by dependency)\n\nReturns:\n    List of UnifiedTool instances from all sources (deduplicated)\n\nPerformance:\n    - First call: <500ms (p95) - database queries\n    - Cached calls: <10ms (p95) - in-memory cache hit\n    - Cache TTL: 60 seconds\n\nExample:\n    GET /api/v1/unified-tools/\n    Headers: X-Tenant-ID: test-tenant\n\n    Response:\n    [\n        {\n            \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n            \"name\": \"get_weather\",\n            \"description\": \"Get current weather information\",\n            \"source_type\": \"openapi\",\n            \"mcp_server_id\": null,\n            \"mcp_primitive_type\": null,\n            \"mcp_server_name\": null,\n            \"input_schema\": {...},\n            \"enabled\": true\n        }\n    ]","operationId":"list_unified_tools_api_v1_unified_tools__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"items":{"$ref":"#/components/schemas/UnifiedTool"},"type":"array","title":"Response List Unified Tools Api V1 Unified Tools  Get"}}}}}}},"/":{"get":{"summary":"Root","description":"Root endpoint for basic health check.\n\nReturns:\n    dict: Simple status message","operationId":"root__get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"type":"string"},"type":"object","title":"Response Root  Get"}}}}}}},"/health":{"get":{"summary":"Health","description":"Health check endpoint for Docker and load balancers.\n\nValidates connectivity to PostgreSQL and Redis dependencies.\nReturns 503 if any dependency is unhealthy.\n\nReturns:\n    dict: Health status with dependency checks\n\nRaises:\n    HTTPException: If any dependency is unhealthy","operationId":"health_health_get","responses":{"200":{"description":"Successful Response","content":{"application/json":{"schema":{"additionalProperties":{"anyOf":[{"type":"string"},{"additionalProperties":true,"type":"object"}]},"type":"object","title":"Response Health Health Get"}}}}}}}},"components":{"schemas":{"AgentCreate":{"properties":{"name":{"type":"string","maxLength":255,"minLength":3,"title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"system_prompt":{"type":"string","maxLength":32000,"minLength":10,"title":"System Prompt"},"llm_config":{"$ref":"#/components/schemas/LLMConfig"},"status":{"$ref":"#/components/schemas/AgentStatus","default":"draft"},"cognitive_architecture":{"$ref":"#/components/schemas/CognitiveArchitecture","description":"Cognitive architecture for execution flow","default":"react"},"created_by":{"anyOf":[{"type":"string","maxLength":255},{"type":"null"}],"title":"Created By"},"triggers":{"items":{"$ref":"#/components/schemas/AgentTriggerCreate"},"type":"array","title":"Triggers"},"tool_ids":{"items":{"type":"string"},"type":"array","maxItems":20,"title":"Tool Ids","description":"OpenAPI tool IDs (from openapi_tools table)"},"mcp_tool_assignments":{"items":{"$ref":"#/components/schemas/MCPToolAssignment"},"type":"array","title":"Mcp Tool Assignments","description":"MCP tool assignments (tools, resources, prompts from MCP servers)"},"memory_config":{"anyOf":[{"$ref":"#/components/schemas/MemoryConfig"},{"type":"null"}]}},"type":"object","required":["name","system_prompt","llm_config"],"title":"AgentCreate","description":"Schema for creating new agents.\n\nAll fields except triggers and tool_ids are required. Agents default to\nDRAFT status and must be explicitly activated. System prompt must be\nbetween 10-32000 characters (reasonable prompt length).\n\nAttributes:\n    name: Human-readable agent name (3-255 chars)\n    description: Optional detailed description\n    system_prompt: LLM system prompt (10-32000 chars)\n    llm_config: LLM configuration (provider, model, temperature, max_tokens)\n    status: Agent status (default: draft)\n    created_by: Optional user who created agent\n    triggers: List of triggers to create with agent\n    tool_ids: List of OpenAPI tool IDs to assign\n    mcp_tool_assignments: List of MCP tool assignments\n    cognitive_architecture: Cognitive architecture to use (default: react)","example":{"created_by":"admin@example.com","description":"Enhances ServiceDesk tickets with context from history and docs","llm_config":{"max_tokens":4096,"model":"gpt-4","provider":"litellm","temperature":0.7},"name":"Ticket Enhancement Agent","status":"draft","system_prompt":"You are a helpful assistant that enhances support tickets...","tool_ids":["servicedesk_plus"],"triggers":[{"trigger_type":"webhook","webhook_url":"/agents/uuid-123/webhook"}]}},"AgentExecutionRequest":{"properties":{"agent_id":{"type":"string","format":"uuid","title":"Agent Id","description":"Agent UUID to execute"},"user_message":{"type":"string","maxLength":10000,"minLength":1,"title":"User Message","description":"User's input message to the agent"},"context":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Context","description":"Optional context dict for prompt variable substitution"},"timeout_seconds":{"type":"integer","maximum":600.0,"minimum":10.0,"title":"Timeout Seconds","description":"Maximum execution time in seconds (10-600)","default":120}},"type":"object","required":["agent_id","user_message"],"title":"AgentExecutionRequest","description":"Request schema for agent execution.","example":{"agent_id":"550e8400-e29b-41d4-a716-446655440000","context":{"priority":"high","ticket_id":123},"timeout_seconds":120,"user_message":"Analyze ticket #123 and suggest resolution steps"}},"AgentExecutionResponse":{"properties":{"success":{"type":"boolean","title":"Success","description":"Whether execution succeeded"},"response":{"type":"string","title":"Response","description":"Agent's final response text"},"tool_calls":{"items":{"$ref":"#/components/schemas/ToolCall"},"type":"array","title":"Tool Calls","description":"History of tool invocations during execution"},"execution_time_seconds":{"type":"number","title":"Execution Time Seconds","description":"Total execution time in seconds"},"model_used":{"type":"string","title":"Model Used","description":"LLM model used (e.g., openai/gpt-4o-mini)"},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error","description":"Error message if success=False"}},"type":"object","required":["success","response","tool_calls","execution_time_seconds","model_used"],"title":"AgentExecutionResponse","description":"Response schema for agent execution.","example":{"execution_time_seconds":3.45,"model_used":"openai/gpt-4o-mini","response":"I've analyzed ticket #123. Here are the resolution steps...","success":true,"tool_calls":[{"timestamp":"2025-01-09T12:34:56.789Z","tool_input":{"ticket_id":123},"tool_name":"get_ticket_details","tool_output":"{\"id\": 123, \"status\": \"open\", ...}"}]}},"AgentResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"tenant_id":{"type":"string","title":"Tenant Id"},"name":{"type":"string","title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"status":{"$ref":"#/components/schemas/AgentStatus"},"system_prompt":{"type":"string","title":"System Prompt"},"llm_config":{"additionalProperties":true,"type":"object","title":"Llm Config"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"},"created_by":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Created By"},"cognitive_architecture":{"$ref":"#/components/schemas/CognitiveArchitecture","default":"react"},"triggers":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Triggers"},"tool_ids":{"items":{"type":"string"},"type":"array","title":"Tool Ids"},"mcp_tool_assignments":{"items":{"$ref":"#/components/schemas/MCPToolAssignment"},"type":"array","title":"Mcp Tool Assignments","description":"MCP tool assignments (tools, resources, prompts from MCP servers)"},"webhook_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Webhook Url","description":"Auto-generated webhook URL for triggering agent (/agents/{agent_id}/webhook)"},"hmac_secret_masked":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Hmac Secret Masked","description":"Masked HMAC secret for webhook signature validation (use Show Secret to reveal)"}},"type":"object","required":["id","tenant_id","name","description","status","system_prompt","llm_config","created_at","updated_at","created_by"],"title":"AgentResponse","description":"Schema for agent API responses.\n\nFull agent details including relationships (triggers, tools). Used for\nGET /agents/{id} and POST /agents responses. Includes ORM mapping via\nfrom_attributes for seamless SQLAlchemy model conversion.\n\nAttributes:\n    id: Agent UUID\n    tenant_id: Tenant identifier\n    name: Agent name\n    description: Agent description\n    status: Current status\n    system_prompt: System prompt\n    llm_config: LLM configuration (serialized JSONB dict)\n    created_at: Creation timestamp\n    updated_at: Last update timestamp\n    created_by: Creator identifier\n    triggers: List of trigger details\n    tool_ids: List of assigned OpenAPI tool identifiers\n    mcp_tool_assignments: List of MCP tool assignments\n    cognitive_architecture: Cognitive architecture used","example":{"cognitive_architecture":"react","created_at":"2025-11-05T19:00:00Z","created_by":"admin@example.com","description":"Enhances tickets with context","id":"550e8400-e29b-41d4-a716-446655440000","llm_config":{"max_tokens":4096,"model":"gpt-4","provider":"litellm","temperature":0.7},"name":"Ticket Enhancement Agent","status":"active","system_prompt":"You are a helpful assistant...","tenant_id":"tenant_123","tool_ids":["servicedesk_plus","jira"],"triggers":[{"id":"660e8400-e29b-41d4-a716-446655440001","trigger_type":"webhook","webhook_url":"/agents/uuid-123/webhook"}],"updated_at":"2025-11-05T19:30:00Z"}},"AgentSpendDTO":{"properties":{"agent_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Agent Id"},"agent_name":{"type":"string","title":"Agent Name"},"execution_count":{"type":"integer","minimum":0.0,"title":"Execution Count","description":"Number of executions"},"total_cost":{"type":"number","minimum":0.0,"title":"Total Cost","description":"Total cost in USD"},"avg_cost":{"type":"number","minimum":0.0,"title":"Avg Cost","description":"Average cost per execution in USD"}},"type":"object","required":["agent_name","execution_count","total_cost","avg_cost"],"title":"AgentSpendDTO","description":"Agent spend summary with execution statistics.\n\nUsed for AC#6 (cost per agent table)."},"AgentStatus":{"type":"string","enum":["draft","active","suspended","inactive"],"title":"AgentStatus","description":"Agent lifecycle status.\n\nValid transitions:\n- DRAFT → ACTIVE (activate after configuration complete)\n- ACTIVE → SUSPENDED (temporarily pause agent)\n- SUSPENDED → ACTIVE (resume suspended agent)\n- ACTIVE → INACTIVE (soft delete)\n- SUSPENDED → INACTIVE (soft delete from suspended)\n\nInvalid transitions (blocked by validation):\n- ACTIVE → DRAFT (cannot un-activate)\n- INACTIVE → * (cannot reactivate deleted agents)"},"AgentTestRequest":{"properties":{"payload":{"additionalProperties":true,"type":"object","title":"Payload","description":"Test payload: webhook data or trigger params"},"simulate_webhook":{"type":"boolean","title":"Simulate Webhook","description":"True for webhook simulation, False for scheduled trigger","default":true}},"type":"object","required":["payload"],"title":"AgentTestRequest","description":"Request to execute agent test.\n\nAttributes:\n    payload: Test payload (webhook data or trigger parameters)\n    simulate_webhook: True to simulate webhook trigger (False for scheduled)"},"AgentTestResponse":{"properties":{"test_id":{"type":"string","format":"uuid","title":"Test Id","description":"Test execution ID"},"agent_id":{"type":"string","format":"uuid","title":"Agent Id","description":"Agent being tested"},"status":{"type":"string","title":"Status","description":"'success' or 'failed'"},"execution_trace":{"$ref":"#/components/schemas/ExecutionTrace","description":"Step-by-step execution"},"token_usage":{"$ref":"#/components/schemas/TokenUsage","description":"Token usage and cost"},"execution_time":{"$ref":"#/components/schemas/ExecutionTiming","description":"Timing breakdown"},"errors":{"anyOf":[{"$ref":"#/components/schemas/ErrorDetails"},{"type":"null"}],"description":"Error details if failed"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"When test was executed"}},"type":"object","required":["test_id","agent_id","status","execution_trace","token_usage","execution_time","created_at"],"title":"AgentTestResponse","description":"Response from agent test execution.\n\nAttributes:\n    test_id: UUID of this test execution\n    agent_id: Agent being tested\n    status: success or failed\n    execution_trace: Step-by-step execution details\n    token_usage: Token tracking\n    execution_time: Timing breakdown\n    errors: Error details if failed\n    created_at: When test was executed"},"AgentTriggerCreate":{"properties":{"trigger_type":{"$ref":"#/components/schemas/TriggerType"},"webhook_url":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Webhook Url"},"hmac_secret":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Hmac Secret"},"schedule_cron":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Schedule Cron"},"payload_schema":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Payload Schema"}},"type":"object","required":["trigger_type"],"title":"AgentTriggerCreate","description":"Schema for creating agent triggers.\n\nSupports webhook and scheduled triggers with appropriate validation.\nWebhook triggers auto-generate URL and HMAC secret if not provided.\nSchedule triggers require cron expression.\n\nAttributes:\n    trigger_type: Trigger type (webhook or schedule)\n    webhook_url: Optional webhook URL (auto-generated if None)\n    hmac_secret: Optional HMAC secret (auto-generated if None)\n    schedule_cron: Required cron expression for schedule triggers\n    payload_schema: Optional JSON schema for webhook payload validation","examples":[{"hmac_secret":"encrypted_secret_here","trigger_type":"webhook","webhook_url":"/agents/{agent_id}/webhook"},{"schedule_cron":"0 * * * *","trigger_type":"schedule"}]},"AgentUpdate":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":255,"minLength":3},{"type":"null"}],"title":"Name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"system_prompt":{"anyOf":[{"type":"string","maxLength":32000,"minLength":10},{"type":"null"}],"title":"System Prompt"},"llm_config":{"anyOf":[{"$ref":"#/components/schemas/LLMConfig"},{"type":"null"}]},"status":{"anyOf":[{"$ref":"#/components/schemas/AgentStatus"},{"type":"null"}]},"cognitive_architecture":{"anyOf":[{"$ref":"#/components/schemas/CognitiveArchitecture"},{"type":"null"}]},"tool_ids":{"anyOf":[{"items":{"type":"string"},"type":"array","maxItems":20},{"type":"null"}],"title":"Tool Ids","description":"OpenAPI tool IDs (from openapi_tools table)"},"mcp_tool_assignments":{"anyOf":[{"items":{"$ref":"#/components/schemas/MCPToolAssignment"},"type":"array"},{"type":"null"}],"title":"Mcp Tool Assignments","description":"MCP tool assignments (tools, resources, prompts from MCP servers)"}},"type":"object","title":"AgentUpdate","description":"Schema for updating existing agents.\n\nAll fields are optional (partial updates supported). Status transitions\nare validated to prevent invalid state changes (e.g., active→draft).\n\nAttributes:\n    name: Optional agent name update\n    description: Optional description update\n    system_prompt: Optional system prompt update\n    llm_config: Optional LLM configuration update\n    status: Optional status update (validated for valid transitions)\n    tool_ids: Optional list of OpenAPI tool IDs to assign\n    mcp_tool_assignments: Optional list of MCP tool assignments\n    cognitive_architecture: Optional cognitive architecture update","example":{"name":"Updated Ticket Enhancement Agent","status":"active","system_prompt":"You are an expert support assistant...","tool_ids":["servicedesk_plus","jira"]}},"AgenticMemoryConfig":{"properties":{"enabled":{"type":"boolean","title":"Enabled","description":"Enable/disable agent-managed structured note-taking","default":false},"retention_days":{"type":"integer","maximum":3650.0,"minimum":1.0,"title":"Retention Days","description":"Days to retain agentic memories before auto-deletion","default":90}},"type":"object","title":"AgenticMemoryConfig","description":"Agentic memory configuration."},"BYOKDisableResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"reverted_to_platform":{"type":"boolean","title":"Reverted To Platform"},"message":{"type":"string","title":"Message"}},"type":"object","required":["success","reverted_to_platform","message"],"title":"BYOKDisableResponse","description":"Response body for disable BYOK endpoint."},"BYOKEnableRequest":{"properties":{"openai_key":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Openai Key"},"anthropic_key":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Anthropic Key"}},"type":"object","title":"BYOKEnableRequest","description":"Request body for enabling BYOK mode with tenant's API keys."},"BYOKEnableResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"virtual_key_created":{"type":"boolean","title":"Virtual Key Created"},"message":{"type":"string","title":"Message"},"providers_configured":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Providers Configured"}},"type":"object","required":["success","virtual_key_created","message"],"title":"BYOKEnableResponse","description":"Response body for enable BYOK endpoint."},"BYOKRotateKeysRequest":{"properties":{"new_openai_key":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"New Openai Key"},"new_anthropic_key":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"New Anthropic Key"}},"type":"object","title":"BYOKRotateKeysRequest","description":"Request body for rotating BYOK tenant's provider keys."},"BYOKRotateKeysResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"new_virtual_key_created":{"type":"boolean","title":"New Virtual Key Created"},"message":{"type":"string","title":"Message"},"providers_updated":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Providers Updated"}},"type":"object","required":["success","new_virtual_key_created","message"],"title":"BYOKRotateKeysResponse","description":"Response body for rotate keys endpoint."},"BYOKStatusResponse":{"properties":{"byok_enabled":{"type":"boolean","title":"Byok Enabled"},"providers_configured":{"items":{"type":"string"},"type":"array","title":"Providers Configured"},"enabled_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Enabled At"},"cost_tracking_mode":{"type":"string","title":"Cost Tracking Mode"}},"type":"object","required":["byok_enabled","providers_configured","cost_tracking_mode"],"title":"BYOKStatusResponse","description":"Response body for BYOK status endpoint."},"BYOKTestKeysRequest":{"properties":{"openai_key":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Openai Key"},"anthropic_key":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Anthropic Key"}},"type":"object","title":"BYOKTestKeysRequest","description":"Request body for testing tenant's provider API keys."},"BYOKTestKeysResponse":{"properties":{"openai":{"$ref":"#/components/schemas/ProviderValidationResult"},"anthropic":{"$ref":"#/components/schemas/ProviderValidationResult"}},"type":"object","required":["openai","anthropic"],"title":"BYOKTestKeysResponse","description":"Response body for test keys endpoint with validation results."},"Body_login_api_auth_token_post":{"properties":{"grant_type":{"anyOf":[{"type":"string","pattern":"^password$"},{"type":"null"}],"title":"Grant Type"},"username":{"type":"string","title":"Username"},"password":{"type":"string","format":"password","title":"Password"},"scope":{"type":"string","title":"Scope","default":""},"client_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Client Id"},"client_secret":{"anyOf":[{"type":"string"},{"type":"null"}],"format":"password","title":"Client Secret"}},"type":"object","required":["username","password"],"title":"Body_login_api_auth_token_post"},"BudgetExceededResponse":{"properties":{"detail":{"type":"string","title":"Detail","description":"Error message"},"tenant_id":{"type":"string","title":"Tenant Id","description":"Tenant identifier"},"current_spend":{"type":"number","title":"Current Spend","description":"Current spend in USD"},"max_budget":{"type":"number","title":"Max Budget","description":"Maximum budget in USD"},"grace_threshold":{"type":"number","title":"Grace Threshold","description":"Grace threshold percentage (e.g., 110.0)"}},"type":"object","required":["detail","tenant_id","current_spend","max_budget","grace_threshold"],"title":"BudgetExceededResponse","description":"Response schema for budget exceeded error."},"BudgetOverrideRequest":{"properties":{"override_amount":{"type":"number","exclusiveMinimum":0.0,"title":"Override Amount","description":"Temporary budget increase amount in dollars"},"duration_days":{"type":"integer","maximum":90.0,"exclusiveMinimum":0.0,"title":"Duration Days","description":"Override duration in days (max 90)"},"reason":{"type":"string","minLength":10,"title":"Reason","description":"Reason for budget override (min 10 chars)"}},"type":"object","required":["override_amount","duration_days","reason"],"title":"BudgetOverrideRequest","description":"Request schema for budget override."},"BudgetUtilizationDTO":{"properties":{"tenant_id":{"type":"string","title":"Tenant Id"},"tenant_name":{"type":"string","title":"Tenant Name"},"budget_limit":{"type":"number","minimum":0.0,"title":"Budget Limit","description":"Monthly budget limit in USD"},"current_spend":{"type":"number","minimum":0.0,"title":"Current Spend","description":"Current month spend in USD"},"remaining":{"type":"number","minimum":0.0,"title":"Remaining","description":"Remaining budget in USD"},"utilization_pct":{"type":"number","maximum":200.0,"minimum":0.0,"title":"Utilization Pct","description":"Budget utilization percentage"},"color":{"type":"string","pattern":"^(green|yellow|red)$","title":"Color","description":"Color indicator (green/yellow/red)"},"is_byok":{"type":"boolean","title":"Is Byok","description":"True if tenant uses own keys (BYOK)","default":false}},"type":"object","required":["tenant_id","tenant_name","budget_limit","current_spend","remaining","utilization_pct","color"],"title":"BudgetUtilizationDTO","description":"Tenant budget utilization summary.\n\nUsed for AC#5 (budget utilization progress bars)."},"BudgetWebhookPayload":{"properties":{"spend":{"type":"number","minimum":0.0,"title":"Spend","description":"Current spend in USD"},"max_budget":{"type":"number","exclusiveMinimum":0.0,"title":"Max Budget","description":"Maximum budget in USD"},"token":{"type":"string","title":"Token","description":"LiteLLM virtual key token (hashed)"},"user_id":{"type":"string","title":"User Id","description":"User ID (tenant_id in our system)"},"team_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Team Id","description":"Team ID (optional)"},"user_email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"User Email","description":"User email (optional)"},"key_alias":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Key Alias","description":"Key alias for identification"},"projected_exceeded_date":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Projected Exceeded Date","description":"Projected date when budget will be exceeded"},"projected_spend":{"anyOf":[{"type":"number"},{"type":"null"}],"title":"Projected Spend","description":"Projected spend at end of period"},"event":{"type":"string","title":"Event","description":"Event type: threshold_crossed, budget_crossed, projected_limit_exceeded"},"event_group":{"type":"string","title":"Event Group","description":"Event group: user, team, key"},"event_message":{"type":"string","title":"Event Message","description":"Human-readable event message"}},"type":"object","required":["spend","max_budget","token","user_id","event","event_group","event_message"],"title":"BudgetWebhookPayload","description":"LiteLLM budget webhook payload schema.\n\nMatches the webhook payload structure sent by LiteLLM proxy when\nbudget thresholds are crossed. See LiteLLM docs for field details.\n\nAttributes:\n    spend: Current spend in USD\n    max_budget: Maximum budget in USD\n    token: LiteLLM virtual key token (hashed for security)\n    user_id: User ID (maps to tenant_id in our system)\n    team_id: Team ID (optional, not used in our implementation)\n    user_email: User email (optional)\n    key_alias: Key alias for identification\n    projected_exceeded_date: Projected date when budget will be exceeded (optional)\n    projected_spend: Projected spend at end of period (optional)\n    event: Event type (threshold_crossed, budget_crossed, projected_limit_exceeded)\n    event_group: Event group (user, team, key)\n    event_message: Human-readable event message"},"ChangePasswordRequest":{"properties":{"current_password":{"type":"string","title":"Current Password"},"new_password":{"type":"string","title":"New Password"}},"type":"object","required":["current_password","new_password"],"title":"ChangePasswordRequest","description":"Password change request.","example":{"current_password":"OldPass123!","new_password":"NewSecurePass456!"}},"CognitiveArchitecture":{"type":"string","enum":["react","single_step","plan_and_solve"],"title":"CognitiveArchitecture","description":"Cognitive architectures for agent execution.\n\nREACT: Standard ReAct loop (Reason + Act). Best for tool use.\nSINGLE_STEP: Zero-shot execution. Best for simple tasks.\nPLAN_AND_SOLVE: Plan-and-Solve pattern. Best for complex, multi-step goals."},"ConfigFieldSchema":{"properties":{"field_name":{"type":"string","title":"Field Name"},"field_type":{"type":"string","title":"Field Type"},"required":{"type":"boolean","title":"Required"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"default":{"anyOf":[{},{"type":"null"}],"title":"Default"},"min_length":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Min Length"},"max_length":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Max Length"},"pattern":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Pattern"},"enum_values":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Enum Values"}},"type":"object","required":["field_name","field_type","required"],"title":"ConfigFieldSchema","description":"JSON Schema representation of a configuration field."},"ConnectionTestRequest":{"properties":{"config":{"additionalProperties":true,"type":"object","title":"Config","description":"Plugin configuration to test (e.g., url, api_token)"}},"type":"object","required":["config"],"title":"ConnectionTestRequest","description":"Request for POST /api/plugins/{plugin_id}/test endpoint."},"ConnectionTestResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"message":{"type":"string","title":"Message"},"details":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Details"}},"type":"object","required":["success","message"],"title":"ConnectionTestResponse","description":"Response for connection test endpoint."},"CostSummaryDTO":{"properties":{"today_spend":{"type":"number","minimum":0.0,"title":"Today Spend","description":"Spend today in USD"},"week_spend":{"type":"number","minimum":0.0,"title":"Week Spend","description":"Spend this week in USD"},"month_spend":{"type":"number","minimum":0.0,"title":"Month Spend","description":"Spend this month in USD"},"total_spend_30d":{"type":"number","minimum":0.0,"title":"Total Spend 30D","description":"Total spend last 30 days in USD"},"top_tenant":{"anyOf":[{"$ref":"#/components/schemas/TenantSpendDTO"},{"type":"null"}]},"top_agent":{"anyOf":[{"$ref":"#/components/schemas/AgentSpendDTO"},{"type":"null"}]}},"type":"object","required":["today_spend","week_spend","month_spend","total_spend_30d"],"title":"CostSummaryDTO","description":"Overall cost summary with multiple time periods.\n\nUsed for AC#2 (overview metrics)."},"DailySpendDTO":{"properties":{"date":{"type":"string","format":"date","title":"Date"},"total_spend":{"type":"number","minimum":0.0,"title":"Total Spend","description":"Total spend for the day in USD"},"transaction_count":{"type":"integer","minimum":0.0,"title":"Transaction Count","description":"Number of LLM API calls on this day"}},"type":"object","required":["date","total_spend","transaction_count"],"title":"DailySpendDTO","description":"Daily spend aggregation for trend chart.\n\nUsed for AC#3 (cost trends chart - last 30 days)."},"EnhancementPreferences":{"properties":{"max_enhancement_length":{"type":"integer","maximum":2000.0,"minimum":100.0,"title":"Max Enhancement Length","default":500},"include_monitoring":{"type":"boolean","title":"Include Monitoring","default":true},"kb_timeout_seconds":{"type":"integer","maximum":60.0,"minimum":1.0,"title":"Kb Timeout Seconds","default":10}},"type":"object","title":"EnhancementPreferences","description":"Tenant-specific enhancement processing preferences.\n\nAttributes:\n    max_enhancement_length: Maximum length of generated enhancement (100-2000 chars)\n    include_monitoring: Include monitoring data in context gathering\n    kb_timeout_seconds: Timeout for knowledge base searches (1-60 seconds)"},"ErrorDetails":{"properties":{"error_type":{"type":"string","title":"Error Type","description":"Type of error"},"message":{"type":"string","title":"Message","description":"Error message"},"stack_trace":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Stack Trace","description":"Full stack trace"}},"type":"object","required":["error_type","message"],"title":"ErrorDetails","description":"Error information if execution failed.\n\nAttributes:\n    error_type: Type of error\n    message: Error message\n    stack_trace: Full stack trace for debugging"},"ExecutionDetailResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id","description":"Execution record ID (globally unique)"},"agent_id":{"type":"string","format":"uuid","title":"Agent Id","description":"Agent ID that was executed"},"tenant_id":{"type":"string","title":"Tenant Id","description":"Tenant identifier for isolation"},"input_data":{"additionalProperties":true,"type":"object","title":"Input Data","description":"Test payload or trigger parameters"},"output_data":{"additionalProperties":true,"type":"object","title":"Output Data","description":"Execution trace with step-by-step execution details"},"status":{"type":"string","title":"Status","description":"Execution status: success or failed"},"execution_time":{"type":"integer","title":"Execution Time","description":"Total execution duration in milliseconds"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Execution creation timestamp"},"updated_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Updated At","description":"Last update timestamp (nullable)"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message","description":"Error message if execution failed (nullable)"},"task_id":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Task Id","description":"Celery task ID for correlation with webhook response (nullable)"}},"type":"object","required":["id","agent_id","tenant_id","input_data","output_data","status","execution_time","created_at"],"title":"ExecutionDetailResponse","description":"Response schema for GET /api/executions/{execution_id}.\n\nRepresents a single agent test execution record with full details including\ninput payload, execution trace, token usage, timing, and errors. Sensitive\ndata (API keys, passwords, tokens) is masked before returning.\n\nAttributes:\n    id: Execution record UUID (globally unique)\n    agent_id: UUID of the agent that was executed\n    tenant_id: Tenant identifier for multi-tenant isolation\n    input_data: Test payload (webhook data or trigger parameters)\n    output_data: Execution trace with step-by-step details\n    status: Execution status (success/failed)\n    execution_time: Total execution duration in milliseconds\n    created_at: Timestamp when execution was created\n    updated_at: Timestamp when execution was last updated (nullable)\n    error_message: Error details if execution failed (nullable)\n    task_id: Celery task ID for correlation with webhook response (nullable)"},"ExecutionStep":{"properties":{"step_number":{"type":"integer","minimum":1.0,"title":"Step Number","description":"Sequence number in execution"},"step_type":{"type":"string","title":"Step Type","description":"'tool_call' or 'llm_request'"},"tool_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Tool Name","description":"Name of tool (for tool calls)"},"model":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Model","description":"Model name (for LLM requests)"},"input":{"additionalProperties":true,"type":"object","title":"Input","description":"Input parameters"},"output":{"title":"Output","description":"Result or response"},"timestamp":{"type":"string","format":"date-time","title":"Timestamp","description":"When this step executed"},"duration_ms":{"type":"number","minimum":0.0,"title":"Duration Ms","description":"Execution time in milliseconds"}},"type":"object","required":["step_number","step_type","input","output","timestamp","duration_ms"],"title":"ExecutionStep","description":"Single step in agent execution trace.\n\nAttributes:\n    step_number: Sequence number in execution\n    step_type: \"tool_call\" or \"llm_request\"\n    tool_name: Name of tool called (for tool_call steps)\n    model: Model name (for llm_request steps)\n    input: Input parameters\n    output: Result/response\n    timestamp: ISO 8601 timestamp with nanosecond precision\n    duration_ms: How long this step took"},"ExecutionTiming":{"properties":{"total_duration_ms":{"type":"number","minimum":0.0,"title":"Total Duration Ms","description":"Total duration in ms"},"steps":{"items":{"additionalProperties":true,"type":"object"},"type":"array","title":"Steps","description":"Breakdown: [{name: str, duration_ms: float}]"}},"type":"object","required":["total_duration_ms"],"title":"ExecutionTiming","description":"Execution timing breakdown.\n\nAttributes:\n    total_duration_ms: Total execution time\n    steps: Breakdown by step (name and duration)"},"ExecutionTrace":{"properties":{"steps":{"items":{"$ref":"#/components/schemas/ExecutionStep"},"type":"array","title":"Steps","description":"List of execution steps"},"total_duration_ms":{"type":"number","minimum":0.0,"title":"Total Duration Ms","description":"Total execution time"},"status":{"type":"string","title":"Status","description":"'success' or 'failed'"}},"type":"object","required":["steps","total_duration_ms","status"],"title":"ExecutionTrace","description":"Complete execution trace with all steps.\n\nAttributes:\n    steps: List of execution steps\n    total_duration_ms: Total execution time\n    status: success or failed"},"FeedbackListResponse":{"properties":{"feedback":{"items":{"$ref":"#/components/schemas/FeedbackRecord"},"type":"array","title":"Feedback","description":"List of feedback records"},"count":{"type":"integer","title":"Count","description":"Total number of feedback records returned"}},"type":"object","required":["count"],"title":"FeedbackListResponse","description":"Response model for feedback list retrieval (GET /api/v1/feedback).\n\nAttributes:\n    feedback: List of feedback records matching query filters\n    count: Total number of records returned","examples":[{"count":1,"feedback":[{"created_at":"2025-11-04T10:30:00Z","enhancement_id":"550e8400-e29b-41d4-a716-446655440000","feedback_comment":"Very helpful!","feedback_type":"rating","id":"7c9e6679-7425-40de-944b-e07fc1f90ae7","rating_value":5,"technician_email":"tech@example.com","tenant_id":"tenant-abc-123","ticket_id":"TKT-001"}]}]},"FeedbackRecord":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"tenant_id":{"type":"string","title":"Tenant Id"},"ticket_id":{"type":"string","title":"Ticket Id"},"enhancement_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Enhancement Id"},"technician_email":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Technician Email"},"feedback_type":{"$ref":"#/components/schemas/FeedbackType"},"rating_value":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Rating Value"},"feedback_comment":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Feedback Comment"},"created_at":{"type":"string","format":"date-time","title":"Created At"}},"type":"object","required":["id","tenant_id","ticket_id","enhancement_id","technician_email","feedback_type","rating_value","feedback_comment","created_at"],"title":"FeedbackRecord","description":"Model representing a single feedback record for GET responses.\n\nUsed in FeedbackListResponse to return feedback history.\n\nAttributes:\n    id: Feedback record UUID\n    tenant_id: Tenant identifier\n    ticket_id: ServiceDesk ticket ID\n    enhancement_id: Reference to enhancement_history (if available)\n    technician_email: Technician email (if provided)\n    feedback_type: Type of feedback (thumbs_up, thumbs_down, rating)\n    rating_value: Numeric rating 1-5 (null for thumbs up/down)\n    feedback_comment: Optional comment text\n    created_at: Timestamp when feedback was submitted"},"FeedbackResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id","description":"UUID of created feedback record"},"status":{"type":"string","title":"Status","description":"Operation status","default":"created"},"message":{"type":"string","title":"Message","description":"Confirmation message","default":"Feedback submitted successfully"}},"type":"object","required":["id"],"title":"FeedbackResponse","description":"Response model for feedback submission.\n\nReturned by POST /api/v1/feedback after successful feedback storage.\n\nAttributes:\n    id: UUID of created feedback record\n    status: Operation status (always \"created\" for successful submissions)\n    message: Human-readable confirmation message","examples":[{"id":"7c9e6679-7425-40de-944b-e07fc1f90ae7","message":"Feedback submitted successfully","status":"created"}]},"FeedbackSubmitRequest":{"properties":{"tenant_id":{"type":"string","maxLength":100,"minLength":1,"title":"Tenant Id","description":"Tenant identifier"},"ticket_id":{"type":"string","maxLength":255,"minLength":1,"title":"Ticket Id","description":"ServiceDesk ticket ID"},"enhancement_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Enhancement Id","description":"Reference to enhancement_history.id"},"technician_email":{"anyOf":[{"type":"string","maxLength":255},{"type":"null"}],"title":"Technician Email","description":"Technician email (optional)"},"feedback_type":{"$ref":"#/components/schemas/FeedbackType","description":"Type of feedback: thumbs_up, thumbs_down, or rating"},"rating_value":{"anyOf":[{"type":"integer","maximum":5.0,"minimum":1.0},{"type":"null"}],"title":"Rating Value","description":"Rating 1-5 (required if feedback_type=rating)"},"feedback_comment":{"anyOf":[{"type":"string","maxLength":5000},{"type":"null"}],"title":"Feedback Comment","description":"Optional feedback comment"}},"type":"object","required":["tenant_id","ticket_id","feedback_type"],"title":"FeedbackSubmitRequest","description":"Request model for submitting enhancement feedback.\n\nUsed by POST /api/v1/feedback endpoint to capture technician satisfaction\nwith ticket enhancements. Supports both quick thumbs up/down feedback\nand detailed 1-5 ratings with optional comments.\n\nAttributes:\n    tenant_id: Tenant identifier (validated against RLS context)\n    ticket_id: ServiceDesk ticket ID that was enhanced\n    enhancement_id: Optional reference to enhancement_history record\n    technician_email: Optional email for feedback attribution (anonymous allowed)\n    feedback_type: Type of feedback (thumbs_up, thumbs_down, rating)\n    rating_value: Numeric rating 1-5 (required if feedback_type=rating, null otherwise)\n    feedback_comment: Optional qualitative feedback text","examples":[{"enhancement_id":"550e8400-e29b-41d4-a716-446655440000","feedback_comment":"Very helpful context, resolved ticket 10 min faster!","feedback_type":"rating","rating_value":5,"technician_email":"tech@example.com","tenant_id":"tenant-abc-123","ticket_id":"TKT-001"},{"feedback_type":"thumbs_up","tenant_id":"tenant-abc-123","ticket_id":"TKT-002"}]},"FeedbackType":{"type":"string","enum":["thumbs_up","thumbs_down","rating"],"title":"FeedbackType","description":"Types of feedback that can be submitted.\n\n- thumbs_up: Positive binary feedback (enhancement was helpful)\n- thumbs_down: Negative binary feedback (enhancement was not helpful)\n- rating: Numeric 1-5 scale rating with optional comment"},"HTTPValidationError":{"properties":{"detail":{"items":{"$ref":"#/components/schemas/ValidationError"},"type":"array","title":"Detail"}},"type":"object","title":"HTTPValidationError"},"LLMConfig":{"properties":{"provider":{"type":"string","maxLength":50,"minLength":1,"title":"Provider","default":"litellm"},"model":{"type":"string","maxLength":100,"minLength":1,"title":"Model"},"temperature":{"type":"number","maximum":2.0,"minimum":0.0,"title":"Temperature","default":0.7},"max_tokens":{"type":"integer","maximum":32000.0,"minimum":1.0,"title":"Max Tokens","default":4096}},"type":"object","required":["model"],"title":"LLMConfig","description":"LLM provider configuration for agents.\n\nFlexible JSONB configuration supporting multiple LLM providers via LiteLLM.\nIncludes validation for temperature and token limits following OpenAI conventions.\n\nAttributes:\n    provider: LLM provider name (default: litellm proxy)\n    model: Model identifier (e.g., gpt-4, claude-3-5-sonnet)\n    temperature: Sampling temperature (0.0-2.0, default 0.7)\n    max_tokens: Maximum tokens in response (1-32000, default 4096)\n\nExample:\n    {\n        \"provider\": \"litellm\",\n        \"model\": \"gpt-4\",\n        \"temperature\": 0.7,\n        \"max_tokens\": 4096\n    }","example":{"max_tokens":4096,"model":"gpt-4","provider":"litellm","temperature":0.7}},"LogoutRequest":{"properties":{"access_token":{"type":"string","title":"Access Token"},"refresh_token":{"type":"string","title":"Refresh Token"}},"type":"object","required":["access_token","refresh_token"],"title":"LogoutRequest","description":"Logout request with tokens to revoke.","example":{"access_token":"eyJhbGciOiJIUzI1NiIs...","refresh_token":"eyJhbGciOiJIUzI1NiIs..."}},"LongTermMemoryConfig":{"properties":{"enabled":{"type":"boolean","title":"Enabled","description":"Enable/disable long-term memory with vector similarity search","default":true},"vector_db":{"type":"string","pattern":"^(postgresql_pgvector|external)$","title":"Vector Db","description":"Vector database backend: postgresql_pgvector or external (future)","default":"postgresql_pgvector"},"retention_days":{"type":"integer","maximum":3650.0,"minimum":1.0,"title":"Retention Days","description":"Days to retain memories before auto-deletion","default":90}},"type":"object","title":"LongTermMemoryConfig","description":"Long-term memory configuration."},"MCPDiscoveredPrompt":{"properties":{"name":{"type":"string","maxLength":100,"minLength":1,"title":"Name","description":"Prompt template identifier","examples":["analyze_code","summarize_docs","debug_error"]},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Explanation of prompt functionality","examples":["Analyze code for issues","Summarize documentation"]},"arguments":{"items":{"$ref":"#/components/schemas/MCPPromptArgument"},"type":"array","title":"Arguments","description":"List of template arguments"}},"type":"object","required":["name"],"title":"MCPDiscoveredPrompt","description":"MCP prompt template discovered from prompts/list endpoint.\n\nPrompts are user-controlled templates for common tasks, allowing servers to\nprovide structured messages and instructions for LLM interactions.\n\nPer MCP Specification 2025-03-26, prompts include:\n- name: Prompt identifier\n- description: Explains provided functionality\n- arguments: Optional list of MCPPromptArgument for template customization\n\nAttributes:\n    name: Prompt template identifier\n    description: Explanation of prompt functionality\n    arguments: List of template arguments (parameters)\n\nExample:\n    {\n        \"name\": \"analyze_code\",\n        \"description\": \"Analyze source code for issues and improvements\",\n        \"arguments\": [\n            {\n                \"name\": \"language\",\n                \"description\": \"Programming language\",\n                \"required\": true\n            },\n            {\n                \"name\": \"include_style\",\n                \"description\": \"Include style suggestions\",\n                \"required\": false\n            }\n        ]\n    }"},"MCPDiscoveredResource":{"properties":{"uri":{"type":"string","maxLength":500,"minLength":1,"title":"Uri","description":"Resource URI (file://, http://, or custom scheme)","examples":["file:///Users/ravi/Documents/config.json","http://localhost:8080/api/schema","db://production/schema"]},"name":{"type":"string","maxLength":255,"minLength":1,"title":"Name","description":"Human-readable resource name","examples":["Application Configuration","Database Schema","API Logs"]},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Explanation of resource contents or purpose","examples":["Main application config file","Production database schema"]},"mimeType":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Mimetype","description":"MIME type indicating content format","examples":["text/plain","application/json","text/csv"]}},"type":"object","required":["uri","name"],"title":"MCPDiscoveredResource","description":"MCP resource discovered from resources/list endpoint.\n\nResources are application-controlled data sources that provide context to LLMs\n(files, database schemas, logs, configuration). Resources are read-only and\nidentified by URI.\n\nPer MCP Specification 2025-03-26, resources include:\n- uri: Resource location (file://, http://, custom schemes)\n- name: Human-readable identifier for UI display\n- description: Explains what resource represents\n- mimeType: Content type if known (text/plain, application/json, etc.)\n\nAttributes:\n    uri: Resource URI (e.g., file:///path/to/file.txt)\n    name: Human-readable resource name for UI population\n    description: Explanation of resource contents/purpose\n    mimeType: MIME type indicating content format\n\nExample:\n    {\n        \"uri\": \"file:///Users/ravi/Documents/config.json\",\n        \"name\": \"Application Configuration\",\n        \"description\": \"Main application config file\",\n        \"mimeType\": \"application/json\"\n    }"},"MCPDiscoveredTool":{"properties":{"name":{"type":"string","maxLength":100,"minLength":1,"title":"Name","description":"Tool identifier for invocation","examples":["read_file","search_database","send_email"]},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Human-readable tool functionality description","examples":["Read file contents","Search database records"]},"inputSchema":{"additionalProperties":true,"type":"object","title":"Inputschema","description":"JSON Schema (draft 2020-12) defining tool parameters","examples":[{"properties":{"path":{"description":"File path","type":"string"}},"required":["path"],"type":"object"}]}},"type":"object","required":["name","inputSchema"],"title":"MCPDiscoveredTool","description":"MCP tool discovered from tools/list endpoint.\n\nTools are model-controlled functions that agents can invoke to interact with\nexternal systems (query databases, call APIs, perform computations).\n\nPer MCP Specification 2025-03-26, tools include:\n- name: Unique identifier for tool invocation\n- description: Explains functionality for LLM context\n- inputSchema: JSON Schema (draft 2020-12) defining parameters\n\nAttributes:\n    name: Tool identifier used in tools/call (unique per server)\n    description: Human-readable explanation of tool functionality\n    inputSchema: JSON Schema object defining expected parameters\n\nExample:\n    {\n        \"name\": \"read_file\",\n        \"description\": \"Read contents of a file from the filesystem\",\n        \"inputSchema\": {\n            \"type\": \"object\",\n            \"properties\": {\n                \"path\": {\"type\": \"string\", \"description\": \"File path\"}\n            },\n            \"required\": [\"path\"]\n        }\n    }"},"MCPPrimitiveType":{"type":"string","enum":["tool","resource","prompt"],"title":"MCPPrimitiveType","description":"MCP primitive types (only applicable when source_type=MCP)."},"MCPPromptArgument":{"properties":{"name":{"type":"string","maxLength":100,"minLength":1,"title":"Name","description":"Argument name identifier","examples":["language","file_path","include_comments"]},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Human-readable description of argument purpose","examples":["Programming language for analysis","Path to file to process"]},"required":{"type":"boolean","title":"Required","description":"Whether this argument must be provided","default":false}},"type":"object","required":["name"],"title":"MCPPromptArgument","description":"Argument definition for MCP prompt templates.\n\nPrompts can accept arguments to customize template behavior. Each argument\nhas a name, optional description, and required flag indicating if the client\nmust provide a value.\n\nPer MCP Specification 2025-03-26, prompt arguments support flexible templating.\n\nAttributes:\n    name: Argument identifier (e.g., 'language', 'file_path')\n    description: Human-readable explanation of argument purpose\n    required: Whether argument must be provided by client (default False)\n\nExample:\n    {\n        \"name\": \"language\",\n        \"description\": \"Programming language (python, javascript, etc.)\",\n        \"required\": true\n    }"},"MCPServerCreate":{"properties":{"name":{"type":"string","maxLength":255,"minLength":1,"title":"Name","description":"Human-readable MCP server name","examples":["Filesystem Server","GitHub MCP","Database Query Server"]},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Detailed description of server purpose","examples":["Local filesystem access via MCP","GitHub API integration for repository operations"]},"transport_type":{"$ref":"#/components/schemas/TransportType","description":"Transport protocol: 'stdio' or 'http_sse'"},"command":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Command","description":"Command to spawn stdio MCP server process","examples":["npx","python","/usr/local/bin/mcp-server"]},"args":{"items":{"type":"string"},"type":"array","title":"Args","description":"Command-line arguments array for stdio","examples":[["-y","@modelcontextprotocol/server-filesystem","/workspace"],["server.py","--port","8080"]]},"env":{"additionalProperties":{"type":"string"},"type":"object","title":"Env","description":"Environment variables object for stdio","examples":[{"API_KEY":"secret","LOG_LEVEL":"debug"},{"NODE_ENV":"production"}]},"url":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Url","description":"Base URL for HTTP+SSE transport","examples":["https://mcp.github.com/api","http://localhost:3000/mcp"]},"headers":{"additionalProperties":{"type":"string"},"type":"object","title":"Headers","description":"HTTP headers for authentication","examples":[{"Authorization":"Bearer ghp_xxxxxxxxxxxx"},{"X-API-Key":"secret_key_here"}]}},"type":"object","required":["name","transport_type"],"title":"MCPServerCreate","description":"Schema for creating new MCP servers.\n\nValidates transport-specific requirements:\n- stdio transport: command required, url/headers not allowed\n- http_sse transport: url required, command/args/env not allowed\n\nFollowing MCP Specification 2025-03-26 transport types.\n\nAttributes:\n    name: Human-readable server name (max 255 chars, unique per tenant)\n    description: Optional detailed description of server purpose\n    transport_type: Transport protocol ('stdio' or 'http_sse')\n    command: Executable path for stdio (e.g., 'npx', '/usr/bin/python3')\n    args: Command-line arguments array for stdio (default [])\n    env: Environment variables object for stdio (default {})\n    url: Base URL for HTTP+SSE transport (max 500 chars)\n    headers: HTTP headers for authentication (default {})\n\nExamples:\n    stdio configuration:\n    {\n        \"name\": \"Filesystem Server\",\n        \"description\": \"Local filesystem access via MCP\",\n        \"transport_type\": \"stdio\",\n        \"command\": \"npx\",\n        \"args\": [\"-y\", \"@modelcontextprotocol/server-filesystem\", \"/Users/ravi/Documents\"],\n        \"env\": {\"LOG_LEVEL\": \"debug\"}\n    }\n\n    http_sse configuration:\n    {\n        \"name\": \"GitHub MCP Server\",\n        \"description\": \"GitHub API integration\",\n        \"transport_type\": \"http_sse\",\n        \"url\": \"https://mcp.github.com/api\",\n        \"headers\": {\"Authorization\": \"Bearer ghp_xxxxxxxxxxxx\"}\n    }","examples":[{"args":["-y","@modelcontextprotocol/server-filesystem","/Users/ravi/Documents"],"command":"npx","description":"Local filesystem access via MCP","env":{"LOG_LEVEL":"debug"},"name":"Filesystem Server","transport_type":"stdio"},{"description":"GitHub API integration","headers":{"Authorization":"Bearer ghp_xxxxxxxxxxxx"},"name":"GitHub MCP Server","transport_type":"http_sse","url":"https://mcp.github.com/api"}]},"MCPServerResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id","description":"Unique server identifier"},"tenant_id":{"type":"string","title":"Tenant Id","description":"Tenant ownership (for multi-tenant isolation)"},"name":{"type":"string","title":"Name","description":"Human-readable server name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Optional server description"},"transport_type":{"$ref":"#/components/schemas/TransportType","description":"Transport protocol: 'stdio' or 'http_sse'"},"command":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Command","description":"stdio command (None for http_sse)"},"args":{"items":{"type":"string"},"type":"array","title":"Args","description":"stdio arguments (empty for http_sse)"},"env":{"additionalProperties":{"type":"string"},"type":"object","title":"Env","description":"stdio environment variables (empty for http_sse)"},"url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Url","description":"HTTP+SSE URL (None for stdio)"},"headers":{"additionalProperties":{"type":"string"},"type":"object","title":"Headers","description":"HTTP headers (empty for stdio)"},"discovered_tools":{"items":{"$ref":"#/components/schemas/MCPDiscoveredTool"},"type":"array","title":"Discovered Tools","description":"Tools from MCP tools/list endpoint"},"discovered_resources":{"items":{"$ref":"#/components/schemas/MCPDiscoveredResource"},"type":"array","title":"Discovered Resources","description":"Resources from MCP resources/list endpoint"},"discovered_prompts":{"items":{"$ref":"#/components/schemas/MCPDiscoveredPrompt"},"type":"array","title":"Discovered Prompts","description":"Prompts from MCP prompts/list endpoint"},"status":{"$ref":"#/components/schemas/MCPServerStatus","description":"Current health status: 'active', 'inactive', or 'error'"},"last_health_check":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Health Check","description":"Last health verification timestamp (ISO 8601)"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message","description":"Error details if status='error'"},"consecutive_failures":{"type":"integer","title":"Consecutive Failures","description":"Number of consecutive failed health checks (circuit breaker triggers at >=3)","default":0},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Server registration timestamp (ISO 8601)"},"updated_at":{"type":"string","format":"date-time","title":"Updated At","description":"Last update timestamp (ISO 8601)"}},"type":"object","required":["id","tenant_id","name","transport_type","status","created_at","updated_at"],"title":"MCPServerResponse","description":"Schema for MCP server API responses.\n\nSerializes complete MCPServer database model including all configuration,\ndiscovered capabilities, health status, and timestamps.\n\nUses ConfigDict(from_attributes=True) for SQLAlchemy ORM compatibility.\nSerializes UUIDs as strings and datetimes as ISO 8601 format.\n\nAttributes:\n    id: Unique server identifier (UUID)\n    tenant_id: Tenant ownership (UUID)\n    name: Human-readable server name\n    description: Optional server description\n    transport_type: Transport protocol ('stdio' or 'http_sse')\n    command: stdio command (None for http_sse)\n    args: stdio arguments array (empty for http_sse)\n    env: stdio environment variables (empty for http_sse)\n    url: HTTP+SSE URL (None for stdio)\n    headers: HTTP headers (empty for stdio)\n    discovered_tools: Tools from tools/list\n    discovered_resources: Resources from resources/list\n    discovered_prompts: Prompts from prompts/list\n    status: Health status ('active', 'inactive', 'error')\n    last_health_check: Last health verification timestamp\n    error_message: Error details if status='error'\n    consecutive_failures: Number of consecutive failed health checks\n    created_at: Registration timestamp\n    updated_at: Last update timestamp\n\nExample:\n    {\n        \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n        \"tenant_id\": \"660e8400-e29b-41d4-a716-446655440001\",\n        \"name\": \"Filesystem Server\",\n        \"description\": \"Local filesystem access\",\n        \"transport_type\": \"stdio\",\n        \"command\": \"npx\",\n        \"args\": [\"-y\", \"@modelcontextprotocol/server-filesystem\"],\n        \"env\": {\"LOG_LEVEL\": \"debug\"},\n        \"url\": null,\n        \"headers\": {},\n        \"discovered_tools\": [\n            {\n                \"name\": \"read_file\",\n                \"description\": \"Read file contents\",\n                \"inputSchema\": {\"type\": \"object\", \"properties\": {...}}\n            }\n        ],\n        \"discovered_resources\": [],\n        \"discovered_prompts\": [],\n        \"status\": \"active\",\n        \"last_health_check\": \"2025-11-09T12:00:00Z\",\n        \"error_message\": null,\n        \"consecutive_failures\": 0,\n        \"created_at\": \"2025-11-09T10:00:00Z\",\n        \"updated_at\": \"2025-11-09T12:00:00Z\"\n    }"},"MCPServerStatus":{"type":"string","enum":["active","inactive","error"],"title":"MCPServerStatus","description":"MCP server health and operational status.\n\nAttributes:\n    ACTIVE: Server is healthy and ready to process requests\n    INACTIVE: Server is registered but not currently in use\n    ERROR: Server encountered an error during last operation"},"MCPServerUpdate":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":255,"minLength":1},{"type":"null"}],"title":"Name","description":"Human-readable MCP server name"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description","description":"Detailed description of server purpose"},"transport_type":{"anyOf":[{"$ref":"#/components/schemas/TransportType"},{"type":"null"}],"description":"Transport protocol: 'stdio' or 'http_sse'"},"command":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Command","description":"Command to spawn stdio MCP server process"},"args":{"anyOf":[{"items":{"type":"string"},"type":"array"},{"type":"null"}],"title":"Args","description":"Command-line arguments array for stdio"},"env":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Env","description":"Environment variables object for stdio"},"url":{"anyOf":[{"type":"string","maxLength":500},{"type":"null"}],"title":"Url","description":"Base URL for HTTP+SSE transport"},"headers":{"anyOf":[{"additionalProperties":{"type":"string"},"type":"object"},{"type":"null"}],"title":"Headers","description":"HTTP headers for authentication"}},"type":"object","title":"MCPServerUpdate","description":"Schema for updating existing MCP servers.\n\nAll fields are optional, allowing partial updates. Transport-specific validation\napplies same rules as MCPServerCreate.\n\nIf transport_type is changed, corresponding transport fields must be provided.\n\nAttributes:\n    name: Optional new server name\n    description: Optional new description\n    transport_type: Optional new transport type\n    command: Optional new command (stdio)\n    args: Optional new arguments (stdio)\n    env: Optional new environment variables (stdio)\n    url: Optional new URL (http_sse)\n    headers: Optional new headers (http_sse)\n\nExample:\n    Partial update (name only):\n    {\"name\": \"Updated Filesystem Server\"}\n\n    Transport type change (stdio → http_sse):\n    {\n        \"transport_type\": \"http_sse\",\n        \"url\": \"https://mcp.example.com/api\",\n        \"command\": null,\n        \"args\": [],\n        \"env\": {}\n    }"},"MCPToolAssignment":{"properties":{"id":{"type":"string","title":"Id","description":"Deterministic UUID5 from UnifiedToolService (server + tool name)"},"name":{"type":"string","title":"Name","description":"Tool/resource/prompt name from MCP server discovery"},"source_type":{"type":"string","const":"mcp","title":"Source Type","description":"Source type, always 'mcp' for this schema"},"mcp_server_id":{"type":"string","format":"uuid","title":"Mcp Server Id","description":"UUID of the MCP server providing this tool"},"mcp_server_name":{"type":"string","title":"Mcp Server Name","description":"Human-readable server name for UI display"},"mcp_primitive_type":{"type":"string","enum":["tool","resource","prompt"],"title":"Mcp Primitive Type","description":"Type of MCP primitive"}},"type":"object","required":["id","name","source_type","mcp_server_id","mcp_server_name","mcp_primitive_type"],"title":"MCPToolAssignment","description":"Represents an MCP tool assignment for an agent.\n\nMCP tools are discovered dynamically from mcp_servers.discovered_* arrays,\nso they don't have stable database records like OpenAPI tools. This schema\ncaptures the metadata needed to identify and invoke MCP tools during agent execution.\n\nAttributes:\n    id: Deterministic UUID5 generated by UnifiedToolService\n    name: Tool/resource/prompt name\n    source_type: Always \"mcp\" (distinguished from \"openapi\")\n    mcp_server_id: UUID of the MCP server providing this tool\n    mcp_server_name: Human-readable server name (for UI display)\n    mcp_primitive_type: Type of MCP primitive (tool/resource/prompt)\n\nExamples:\n    MCP Tool:\n        {\n            \"id\": \"550e8400-e29b-41d4-a716-446655440000\",\n            \"name\": \"get_file_contents\",\n            \"source_type\": \"mcp\",\n            \"mcp_server_id\": \"123e4567-e89b-12d3-a456-426614174000\",\n            \"mcp_server_name\": \"filesystem-server\",\n            \"mcp_primitive_type\": \"tool\"\n        }\n\n    MCP Resource:\n        {\n            \"id\": \"650e8400-e29b-41d4-a716-446655440001\",\n            \"name\": \"resource://config.json\",\n            \"source_type\": \"mcp\",\n            \"mcp_server_id\": \"223e4567-e89b-12d3-a456-426614174001\",\n            \"mcp_server_name\": \"config-server\",\n            \"mcp_primitive_type\": \"resource\"\n        }","example":{"id":"550e8400-e29b-41d4-a716-446655440000","mcp_primitive_type":"tool","mcp_server_id":"123e4567-e89b-12d3-a456-426614174000","mcp_server_name":"weather-api","name":"get_weather","source_type":"mcp"}},"MemoryClearResponse":{"properties":{"agent_id":{"type":"string","format":"uuid","title":"Agent Id","description":"Agent ID"},"cleared_count":{"type":"integer","minimum":0.0,"title":"Cleared Count","description":"Number of memories cleared"},"memory_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Memory Type","description":"Memory type cleared"},"cleared_at":{"type":"string","format":"date-time","title":"Cleared At","description":"Timestamp of clearing"}},"type":"object","required":["agent_id","cleared_count","cleared_at"],"title":"MemoryClearResponse","description":"Response after clearing agent memory."},"MemoryConfig":{"properties":{"short_term":{"$ref":"#/components/schemas/ShortTermMemoryConfig","description":"Short-term conversation memory settings"},"long_term":{"$ref":"#/components/schemas/LongTermMemoryConfig","description":"Long-term semantic memory settings"},"agentic":{"$ref":"#/components/schemas/AgenticMemoryConfig","description":"Agentic memory settings"}},"type":"object","title":"MemoryConfig","description":"Complete agent memory configuration.\n\nCombines all three memory types (short-term, long-term, agentic)\nwith their respective settings."},"MemoryConfigResponse":{"properties":{"agent_id":{"type":"string","format":"uuid","title":"Agent Id","description":"Agent ID"},"config":{"$ref":"#/components/schemas/MemoryConfig","description":"Memory configuration"},"updated_at":{"type":"string","format":"date-time","title":"Updated At","description":"Timestamp of last update"}},"type":"object","required":["agent_id","config","updated_at"],"title":"MemoryConfigResponse","description":"API response for memory configuration endpoints."},"MemoryConfigUpdate":{"properties":{"short_term":{"anyOf":[{"$ref":"#/components/schemas/ShortTermMemoryConfig"},{"type":"null"}],"description":"Update short-term memory settings"},"long_term":{"anyOf":[{"$ref":"#/components/schemas/LongTermMemoryConfig"},{"type":"null"}],"description":"Update long-term memory settings"},"agentic":{"anyOf":[{"$ref":"#/components/schemas/AgenticMemoryConfig"},{"type":"null"}],"description":"Update agentic memory settings"}},"type":"object","title":"MemoryConfigUpdate","description":"Schema for updating agent memory configuration.\n\nAll fields optional to support partial updates."},"MemoryHistoryResponse":{"properties":{"agent_id":{"type":"string","format":"uuid","title":"Agent Id","description":"Agent ID"},"memories":{"items":{"$ref":"#/components/schemas/MemoryItem"},"type":"array","title":"Memories","description":"List of memory items"},"total_count":{"type":"integer","minimum":0.0,"title":"Total Count","description":"Total number of memories matching filter"},"page":{"type":"integer","minimum":1.0,"title":"Page","description":"Current page number (1-indexed)","default":1},"page_size":{"type":"integer","maximum":100.0,"minimum":1.0,"title":"Page Size","description":"Number of items per page","default":10},"has_more":{"type":"boolean","title":"Has More","description":"Whether there are more pages available"}},"type":"object","required":["agent_id","memories","total_count","has_more"],"title":"MemoryHistoryResponse","description":"Paginated response for memory history retrieval."},"MemoryItem":{"properties":{"id":{"type":"string","format":"uuid","title":"Id","description":"Memory entry ID (UUID)"},"agent_id":{"type":"string","format":"uuid","title":"Agent Id","description":"ID of agent owning this memory"},"memory_type":{"type":"string","pattern":"^(short_term|long_term|agentic)$","title":"Memory Type","description":"Memory type: short_term, long_term, or agentic"},"content":{"additionalProperties":true,"type":"object","title":"Content","description":"Memory content (flexible structure)"},"embedding":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Embedding","description":"Vector embedding (text format for pgvector, 1536 dims)"},"retention_days":{"type":"integer","maximum":3650.0,"minimum":1.0,"title":"Retention Days","description":"Days to retain this memory before auto-deletion","default":90},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"Timestamp when memory was created"},"updated_at":{"type":"string","format":"date-time","title":"Updated At","description":"Timestamp when memory was last updated"}},"type":"object","required":["id","agent_id","memory_type","content","created_at","updated_at"],"title":"MemoryItem","description":"Single memory item entry.\n\nRepresents a memory record stored in agent_memory table."},"MemoryState":{"properties":{"agent_id":{"type":"string","format":"uuid","title":"Agent Id","description":"Agent ID"},"short_term_memories":{"items":{"$ref":"#/components/schemas/MemoryItem"},"type":"array","title":"Short Term Memories","description":"Recent short-term conversation memories"},"long_term_memories":{"items":{"$ref":"#/components/schemas/MemoryItem"},"type":"array","title":"Long Term Memories","description":"Long-term semantic memories with similarity scores"},"agentic_memories":{"items":{"$ref":"#/components/schemas/MemoryItem"},"type":"array","title":"Agentic Memories","description":"Agent-extracted structured memories"},"memory_config":{"$ref":"#/components/schemas/MemoryConfig","description":"Current memory configuration"},"stats":{"additionalProperties":true,"type":"object","title":"Stats","description":"Memory statistics (counts, oldest/newest timestamps)"}},"type":"object","required":["agent_id","memory_config"],"title":"MemoryState","description":"Current memory state for an agent.\n\nIncludes statistics and recent memory entries."},"ModelInfo":{"properties":{"id":{"type":"string","title":"Id","description":"Unique model identifier","examples":["gpt-4","claude-3-opus-20240229"]},"name":{"type":"string","title":"Name","description":"Human-readable model display name","examples":["GPT-4","Claude 3 Opus"]},"provider":{"type":"string","title":"Provider","description":"LLM provider name","examples":["openai","anthropic"]},"max_tokens":{"type":"integer","minimum":1.0,"title":"Max Tokens","description":"Maximum context window in tokens","examples":[8192,200000]},"supports_function_calling":{"type":"boolean","title":"Supports Function Calling","description":"Whether model supports function calling","examples":[true,false]},"input_cost_per_token":{"anyOf":[{"type":"number","minimum":0.0},{"type":"null"}],"title":"Input Cost Per Token","description":"Input token cost (optional, from LiteLLM)","examples":[3e-05]},"output_cost_per_token":{"anyOf":[{"type":"number","minimum":0.0},{"type":"null"}],"title":"Output Cost Per Token","description":"Output token cost (optional, from LiteLLM)","examples":[6e-05]}},"type":"object","required":["id","name","provider","max_tokens","supports_function_calling"],"title":"ModelInfo","description":"LLM Model metadata and capabilities.\n\nRepresents a single model available from LiteLLM proxy, including\nID, display name, provider, token limits, and feature support.\n\nAttributes:\n    id: Unique model identifier (e.g., 'gpt-4', 'claude-3-opus-20240229')\n    name: Human-readable display name (e.g., 'GPT-4', 'Claude 3 Opus')\n    provider: LLM provider name (e.g., 'openai', 'anthropic')\n    max_tokens: Maximum context window in tokens\n    supports_function_calling: Whether model supports function calling capability\n    input_cost_per_token: Cost per input token (optional, from LiteLLM)\n    output_cost_per_token: Cost per output token (optional, from LiteLLM)","example":{"id":"gpt-4","input_cost_per_token":3e-05,"max_tokens":8192,"name":"GPT-4","output_cost_per_token":6e-05,"provider":"openai","supports_function_calling":true}},"ModelSpendDTO":{"properties":{"model_name":{"type":"string","title":"Model Name"},"total_spend":{"type":"number","minimum":0.0,"title":"Total Spend","description":"Total spend in USD"},"total_tokens":{"type":"integer","minimum":0.0,"title":"Total Tokens","description":"Total tokens consumed"},"prompt_tokens":{"type":"integer","minimum":0.0,"title":"Prompt Tokens","description":"Input tokens"},"completion_tokens":{"type":"integer","minimum":0.0,"title":"Completion Tokens","description":"Output tokens"}},"type":"object","required":["model_name","total_spend","total_tokens","prompt_tokens","completion_tokens"],"title":"ModelSpendDTO","description":"Model spend summary.\n\nUsed for AC#2 (spend by model) and AC#4 (token breakdown)."},"ModelSpendResponse":{"properties":{"model":{"type":"string","title":"Model","description":"LLM model name"},"spend":{"type":"number","minimum":0.0,"title":"Spend","description":"Spend in USD"},"percentage":{"type":"number","maximum":100.0,"minimum":0.0,"title":"Percentage","description":"Percentage of total"},"requests":{"type":"integer","minimum":0.0,"title":"Requests","description":"Number of requests"}},"type":"object","required":["model","spend","percentage","requests"],"title":"ModelSpendResponse","description":"Per-model spend breakdown from LiteLLM.\n\nAttributes:\n    model: Model name (e.g., 'gpt-4', 'claude-3-opus')\n    spend: Spend in USD for this model\n    percentage: Percentage of total spend (0-100)\n    requests: Number of requests to this model","example":{"model":"gpt-4","percentage":66.7,"requests":125,"spend":30.5}},"OpenAPITool":{"properties":{"id":{"type":"integer","title":"Id"},"tenant_id":{"type":"string","title":"Tenant Id"},"tool_name":{"type":"string","title":"Tool Name"},"spec_version":{"type":"string","title":"Spec Version"},"base_url":{"type":"string","title":"Base Url"},"status":{"type":"string","title":"Status"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"},"created_by":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Created By"},"tools_generated_count":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Tools Generated Count","description":"Number of MCP tools generated"}},"type":"object","required":["id","tenant_id","tool_name","spec_version","base_url","status","created_at","updated_at"],"title":"OpenAPITool","description":"Schema for OpenAPI tool response."},"OpenAPIToolCreate":{"properties":{"tool_name":{"type":"string","maxLength":255,"minLength":1,"title":"Tool Name","description":"Tool name"},"openapi_spec":{"additionalProperties":true,"type":"object","title":"Openapi Spec","description":"Full OpenAPI specification"},"spec_version":{"type":"string","pattern":"^(2\\.0|3\\.0|3\\.1)$","title":"Spec Version","description":"OpenAPI version"},"base_url":{"type":"string","minLength":1,"title":"Base Url","description":"API base URL"},"auth_config":{"additionalProperties":true,"type":"object","title":"Auth Config","description":"Authentication configuration"},"tenant_id":{"type":"string","maxLength":100,"minLength":1,"title":"Tenant Id","description":"Tenant ID"},"created_by":{"anyOf":[{"type":"string","maxLength":100},{"type":"null"}],"title":"Created By","description":"Creator username"}},"type":"object","required":["tool_name","openapi_spec","spec_version","base_url","tenant_id"],"title":"OpenAPIToolCreate","description":"Schema for creating a new OpenAPI tool.","example":{"auth_config":{"token":"ghp_xxx","type":"bearer"},"base_url":"https://api.github.com","created_by":"admin","openapi_spec":{"info":{"title":"GitHub API"},"openapi":"3.0.0"},"spec_version":"3.0","tenant_id":"test-tenant","tool_name":"GitHub API"}},"PluginConfigSchema":{"properties":{"plugin_id":{"type":"string","title":"Plugin Id"},"schema_fields":{"items":{"$ref":"#/components/schemas/ConfigFieldSchema"},"type":"array","title":"Schema Fields"}},"type":"object","required":["plugin_id","schema_fields"],"title":"PluginConfigSchema","description":"Complete plugin configuration schema."},"PluginDetailsResponse":{"properties":{"plugin_id":{"type":"string","title":"Plugin Id"},"name":{"type":"string","title":"Name"},"version":{"type":"string","title":"Version"},"description":{"type":"string","title":"Description"},"tool_type":{"type":"string","title":"Tool Type"},"config_schema":{"$ref":"#/components/schemas/PluginConfigSchema"}},"type":"object","required":["plugin_id","name","version","description","tool_type","config_schema"],"title":"PluginDetailsResponse","description":"Response for GET /api/plugins/{plugin_id} endpoint."},"PluginListResponse":{"properties":{"plugins":{"items":{"$ref":"#/components/schemas/PluginMetadata"},"type":"array","title":"Plugins"},"count":{"type":"integer","title":"Count","description":"Total number of registered plugins"}},"type":"object","required":["plugins","count"],"title":"PluginListResponse","description":"Response for GET /api/plugins endpoint."},"PluginMetadata":{"properties":{"plugin_id":{"type":"string","title":"Plugin Id","description":"Unique plugin identifier (tool_type)"},"name":{"type":"string","title":"Name","description":"Human-readable plugin name"},"version":{"type":"string","title":"Version","description":"Plugin version"},"status":{"type":"string","title":"Status","description":"Plugin status (active, inactive, error)"},"description":{"type":"string","title":"Description","description":"Brief plugin description"},"tool_type":{"type":"string","title":"Tool Type","description":"Tool type identifier"}},"type":"object","required":["plugin_id","name","version","status","description","tool_type"],"title":"PluginMetadata","description":"Plugin metadata for list display."},"PromptTemplateCreate":{"properties":{"name":{"type":"string","maxLength":255,"minLength":3,"title":"Name"},"description":{"type":"string","maxLength":1000,"minLength":5,"title":"Description"},"template_text":{"type":"string","maxLength":32000,"minLength":10,"title":"Template Text"}},"type":"object","required":["name","description","template_text"],"title":"PromptTemplateCreate","description":"Schema for creating custom prompt templates.\n\nAttributes:\n    name: Template name (3-255 chars)\n    description: Purpose and usage description (required)\n    template_text: Prompt with {{variable}} placeholders","example":{"description":"Agent that enhances support tickets with context from history and documentation","name":"Ticket Enhancement","template_text":"You are an AI assistant for {{tenant_name}}..."}},"PromptTemplateResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"name":{"type":"string","title":"Name"},"description":{"type":"string","title":"Description"},"template_text":{"type":"string","title":"Template Text"},"is_builtin":{"type":"boolean","title":"Is Builtin"},"usage_count":{"type":"integer","title":"Usage Count","default":0},"created_by":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Created By"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["id","name","description","template_text","is_builtin","created_at","updated_at"],"title":"PromptTemplateResponse","description":"Schema for prompt template API responses.\n\nAttributes:\n    id: Template UUID\n    name: Template name\n    description: Purpose and usage\n    template_text: Prompt template\n    is_builtin: True for system-provided templates\n    usage_count: Number of agents using this template\n    created_by: User who created custom template\n    created_at: Creation timestamp\n    updated_at: Last modification timestamp","example":{"created_at":"2025-11-05T19:00:00Z","description":"Enhances support tickets with context","id":"550e8400-e29b-41d4-a716-446655440000","is_builtin":true,"name":"Ticket Enhancement","template_text":"You are an AI assistant...","updated_at":"2025-11-05T19:00:00Z","usage_count":3}},"PromptTestRequest":{"properties":{"system_prompt":{"type":"string","maxLength":32000,"minLength":10,"title":"System Prompt"},"user_message":{"type":"string","maxLength":5000,"minLength":1,"title":"User Message"},"model":{"type":"string","maxLength":100,"title":"Model","default":"gpt-4"},"temperature":{"anyOf":[{"type":"number","maximum":2.0,"minimum":0.0},{"type":"null"}],"title":"Temperature"},"max_tokens":{"anyOf":[{"type":"integer","maximum":32000.0,"minimum":1.0},{"type":"null"}],"title":"Max Tokens"}},"type":"object","required":["system_prompt","user_message"],"title":"PromptTestRequest","description":"Schema for testing a prompt with LLM.\n\nAttributes:\n    system_prompt: System prompt to test\n    user_message: Sample user input\n    model: LLM model to use (default: from agent config)\n    temperature: Sampling temperature (optional override)\n    max_tokens: Max tokens in response (optional override)","example":{"max_tokens":1000,"model":"gpt-4","system_prompt":"You are a helpful support assistant...","temperature":0.7,"user_message":"How do I reset my password?"}},"PromptTestResponse":{"properties":{"text":{"type":"string","title":"Text"},"tokens_used":{"additionalProperties":{"type":"integer"},"type":"object","title":"Tokens Used","example":{"input":100,"output":250}},"execution_time":{"type":"integer","title":"Execution Time"},"cost":{"type":"number","title":"Cost"}},"type":"object","required":["text","tokens_used","execution_time","cost"],"title":"PromptTestResponse","description":"Schema for prompt test results.\n\nAttributes:\n    text: LLM response text\n    tokens_used: {input, output} token counts\n    execution_time: Time taken in milliseconds\n    cost: Estimated cost in USD","example":{"cost":0.005,"execution_time":1234,"text":"To reset your password, click the 'Forgot Password' link...","tokens_used":{"input":100,"output":250}}},"PromptVersionDetail":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"created_by":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Created By"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"is_current":{"type":"boolean","title":"Is Current"},"prompt_text":{"type":"string","title":"Prompt Text"}},"type":"object","required":["id","created_at","created_by","description","is_current","prompt_text"],"title":"PromptVersionDetail","description":"Extended version response including full prompt text.\n\nUsed when retrieving a specific version or reverting to a version.\n\nAttributes:\n    prompt_text: The full system prompt text","example":{"created_at":"2025-11-05T19:00:00Z","created_by":"admin@example.com","description":"Updated for better RCA analysis","id":"550e8400-e29b-41d4-a716-446655440000","is_current":true}},"PromptVersionResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"created_by":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Created By"},"description":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Description"},"is_current":{"type":"boolean","title":"Is Current"}},"type":"object","required":["id","created_at","created_by","description","is_current"],"title":"PromptVersionResponse","description":"Schema for prompt version history responses.\n\nReturns metadata about a prompt version without including the full text\n(to reduce response size). Used for version history listing.\n\nAttributes:\n    id: Version UUID\n    created_at: When this version was created\n    created_by: User who created this version\n    description: Optional description of what changed\n    is_current: True if this is the agent's active prompt","example":{"created_at":"2025-11-05T19:00:00Z","created_by":"admin@example.com","description":"Updated for better RCA analysis","id":"550e8400-e29b-41d4-a716-446655440000","is_current":true}},"ProviderValidationResult":{"properties":{"valid":{"type":"boolean","title":"Valid"},"models":{"items":{"type":"string"},"type":"array","title":"Models","default":[]},"error":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error"}},"type":"object","required":["valid"],"title":"ProviderValidationResult","description":"Validation result for a single provider's API key."},"RefreshRequest":{"properties":{"refresh_token":{"type":"string","title":"Refresh Token"}},"type":"object","required":["refresh_token"],"title":"RefreshRequest","description":"Token refresh request.","example":{"refresh_token":"eyJhbGciOiJIUzI1NiIs..."}},"RegisterRequest":{"properties":{"email":{"type":"string","format":"email","title":"Email"},"password":{"type":"string","title":"Password"},"default_tenant_id":{"type":"string","format":"uuid","title":"Default Tenant Id"}},"type":"object","required":["email","password","default_tenant_id"],"title":"RegisterRequest","description":"User registration request.","example":{"default_tenant_id":"123e4567-e89b-12d3-a456-426614174000","email":"user@example.com","password":"SecurePass123!"}},"ResolvedTicketWebhook":{"properties":{"tenant_id":{"type":"string","maxLength":100,"minLength":1,"title":"Tenant Id","description":"Client/tenant identifier for multi-tenant support","example":"acme-corp"},"ticket_id":{"type":"string","maxLength":100,"minLength":1,"title":"Ticket Id","description":"Unique ticket identifier from ServiceDesk Plus","example":"TKT-12345"},"subject":{"type":"string","maxLength":500,"minLength":1,"title":"Subject","description":"Ticket subject or title","example":"Database connection pool exhausted"},"description":{"type":"string","maxLength":10000,"minLength":1,"title":"Description","description":"Ticket description or problem statement (max 10K chars per Epic 3 security AC)","example":"Database connection pool exhausted after office hours backup job."},"resolution":{"type":"string","maxLength":20000,"minLength":1,"title":"Resolution","description":"Resolution or solution applied to the ticket","example":"Increased pool size from 10 to 25. Added monitoring alert."},"resolved_date":{"type":"string","format":"date-time","title":"Resolved Date","description":"ISO 8601 timestamp when ticket was resolved with timezone","example":"2025-11-01T14:30:00Z"},"priority":{"type":"string","enum":["low","medium","high","critical"],"title":"Priority","description":"Ticket priority level","example":"high"},"tags":{"items":{"type":"string"},"type":"array","title":"Tags","description":"Optional tags or categories for the ticket","example":["database","performance","infrastructure"]}},"additionalProperties":false,"type":"object","required":["tenant_id","ticket_id","subject","description","resolution","resolved_date","priority"],"title":"ResolvedTicketWebhook","description":"Schema for resolved ticket webhook payloads from ServiceDesk Plus.\n\nValidates incoming webhook notifications when tickets are marked as resolved or closed.\nUsed for continuous ingestion of resolved tickets into the ticket_history table for\ncontext gathering by the enhancement agent (Story 2.5B).\n\nImplements strict validation per Epic 3 Story 3.4 security requirements.\n\nAttributes:\n    tenant_id: Tenant identifier (lowercase alphanumeric + dashes, max 100 chars)\n    ticket_id: Unique identifier (alphanumeric + dashes, max 100 chars)\n    subject: Ticket subject/title (max 500 chars)\n    description: Ticket description (max 10,000 chars)\n    resolution: Resolution or solution (max 20,000 chars)\n    resolved_date: ISO 8601 timestamp with timezone\n    priority: Ticket priority level (low, medium, high, critical)\n    tags: Optional list of tags/categories\n\nRaises:\n    ValidationError: If any field fails validation (invalid format, missing timezone, etc.)\n\nExample:\n    {\n        \"tenant_id\": \"acme-corp\",\n        \"ticket_id\": \"TKT-12345\",\n        \"subject\": \"Database connection pool exhausted\",\n        \"description\": \"Database connection pool exhausted after office hours backup job.\",\n        \"resolution\": \"Increased pool size from 10 to 25. Added monitoring alert.\",\n        \"resolved_date\": \"2025-11-01T14:30:00Z\",\n        \"priority\": \"high\",\n        \"tags\": [\"database\", \"performance\", \"infrastructure\"]\n    }","example":{"description":"Database connection pool exhausted after office hours backup job.","priority":"high","resolution":"Increased pool size from 10 to 25. Added monitoring alert.","resolved_date":"2025-11-01T14:30:00Z","subject":"Database connection pool exhausted","tags":["database","performance","infrastructure"],"tenant_id":"acme-corp","ticket_id":"TKT-12345"}},"RoleAssignment":{"properties":{"tenant_id":{"type":"string","format":"uuid","title":"Tenant Id"},"role":{"$ref":"#/components/schemas/RoleEnum"}},"type":"object","required":["tenant_id","role"],"title":"RoleAssignment","description":"User role assignment for a tenant."},"RoleEnum":{"type":"string","enum":["super_admin","tenant_admin","operator","developer","viewer"],"title":"RoleEnum","description":"RBAC roles for the AI Agents Platform.\n\nRoles are hierarchical (super_admin > tenant_admin > operator > developer > viewer).\nEach role has specific permissions defined in the permission matrix (see tech-spec).\n\nRoles:\n    super_admin: Platform administrator (all permissions, all tenants)\n    tenant_admin: Tenant administrator (all permissions within tenant)\n    operator: Operations team member (can pause/resume, view executions)\n    developer: Developer (can create/edit agents, test agents)\n    viewer: Read-only access (can view dashboards, metrics, history)"},"ShortTermMemoryConfig":{"properties":{"context_window_size":{"type":"integer","maximum":32768.0,"minimum":256.0,"title":"Context Window Size","description":"Max tokens in context window","default":4096},"conversation_history_length":{"type":"integer","maximum":100.0,"minimum":1.0,"title":"Conversation History Length","description":"Max conversation messages to retain","default":10}},"type":"object","title":"ShortTermMemoryConfig","description":"Short-term memory configuration."},"SourceType":{"type":"string","enum":["openapi","mcp"],"title":"SourceType","description":"Source type for unified tools."},"TenantConfigCreate":{"properties":{"tenant_id":{"type":"string","maxLength":100,"pattern":"^[a-z0-9\\-]+$","title":"Tenant Id"},"name":{"type":"string","maxLength":255,"minLength":1,"title":"Name"},"tool_type":{"type":"string","title":"Tool Type","default":"servicedesk_plus"},"servicedesk_url":{"anyOf":[{"type":"string","maxLength":2083,"minLength":1,"format":"uri"},{"type":"null"}],"title":"Servicedesk Url"},"servicedesk_api_key":{"anyOf":[{"type":"string","minLength":1},{"type":"null"}],"title":"Servicedesk Api Key"},"jira_url":{"anyOf":[{"type":"string","maxLength":2083,"minLength":1,"format":"uri"},{"type":"null"}],"title":"Jira Url"},"jira_api_token":{"anyOf":[{"type":"string","minLength":1},{"type":"null"}],"title":"Jira Api Token"},"jira_project_key":{"anyOf":[{"type":"string","minLength":1},{"type":"null"}],"title":"Jira Project Key"},"webhook_signing_secret":{"type":"string","minLength":1,"title":"Webhook Signing Secret"},"enhancement_preferences":{"anyOf":[{"$ref":"#/components/schemas/EnhancementPreferences"},{"type":"null"}]}},"type":"object","required":["tenant_id","name","webhook_signing_secret"],"title":"TenantConfigCreate","description":"Request model for creating tenant configuration.\n\nSupports multiple ticketing tools via plugin architecture.\nTool-specific fields required based on tool_type."},"TenantConfigListResponse":{"properties":{"items":{"items":{"$ref":"#/components/schemas/TenantConfigResponse"},"type":"array","title":"Items"},"total_count":{"type":"integer","title":"Total Count"},"skip":{"type":"integer","title":"Skip"},"limit":{"type":"integer","title":"Limit"}},"type":"object","required":["items","total_count","skip","limit"],"title":"TenantConfigListResponse","description":"Paginated list response for GET /admin/tenants.\n\nAttributes:\n    items: List of tenant configurations (with masked sensitive fields)\n    total_count: Total number of tenants in system\n    skip: Number of records skipped in pagination\n    limit: Number of records returned"},"TenantConfigResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"tenant_id":{"type":"string","title":"Tenant Id"},"name":{"type":"string","title":"Name"},"tool_type":{"type":"string","title":"Tool Type"},"servicedesk_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Servicedesk Url"},"servicedesk_api_key_encrypted":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Servicedesk Api Key Encrypted","default":"***encrypted***"},"jira_url":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Jira Url"},"jira_api_token_encrypted":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Jira Api Token Encrypted","default":"***encrypted***"},"jira_project_key":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Jira Project Key"},"webhook_signing_secret_encrypted":{"type":"string","title":"Webhook Signing Secret Encrypted","default":"***encrypted***"},"enhancement_preferences":{"$ref":"#/components/schemas/EnhancementPreferences"},"is_active":{"type":"boolean","title":"Is Active"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"updated_at":{"type":"string","format":"date-time","title":"Updated At"}},"type":"object","required":["id","tenant_id","name","tool_type","enhancement_preferences","is_active","created_at","updated_at"],"title":"TenantConfigResponse","description":"Response model for GET endpoints.\n\nSensitive fields (api_key, webhook_secret) are masked in responses.\nSupports multi-tool architecture with tool-specific fields."},"TenantConfigUpdate":{"properties":{"name":{"anyOf":[{"type":"string","maxLength":255,"minLength":1},{"type":"null"}],"title":"Name"},"tool_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Tool Type"},"servicedesk_url":{"anyOf":[{"type":"string","maxLength":2083,"minLength":1,"format":"uri"},{"type":"null"}],"title":"Servicedesk Url"},"servicedesk_api_key":{"anyOf":[{"type":"string","minLength":1},{"type":"null"}],"title":"Servicedesk Api Key"},"jira_url":{"anyOf":[{"type":"string","maxLength":2083,"minLength":1,"format":"uri"},{"type":"null"}],"title":"Jira Url"},"jira_api_token":{"anyOf":[{"type":"string","minLength":1},{"type":"null"}],"title":"Jira Api Token"},"jira_project_key":{"anyOf":[{"type":"string","minLength":1},{"type":"null"}],"title":"Jira Project Key"},"webhook_signing_secret":{"anyOf":[{"type":"string","minLength":1},{"type":"null"}],"title":"Webhook Signing Secret"},"enhancement_preferences":{"anyOf":[{"additionalProperties":true,"type":"object"},{"type":"null"}],"title":"Enhancement Preferences"}},"type":"object","title":"TenantConfigUpdate","description":"Request model for updating tenant configuration.\n\nAll fields are optional - only provided fields will be updated."},"TenantSpendDTO":{"properties":{"tenant_id":{"type":"string","title":"Tenant Id"},"tenant_name":{"type":"string","title":"Tenant Name"},"total_spend":{"type":"number","minimum":0.0,"title":"Total Spend","description":"Total spend in USD"},"rank":{"type":"integer","maximum":10.0,"minimum":1.0,"title":"Rank","description":"Rank by spend (1=highest)"}},"type":"object","required":["tenant_id","tenant_name","total_spend","rank"],"title":"TenantSpendDTO","description":"Tenant spend summary.\n\nUsed for AC#2 (spend by tenant - top 10)."},"TenantSpendResponse":{"properties":{"tenant_id":{"type":"string","title":"Tenant Id","description":"Tenant identifier"},"current_spend":{"type":"number","minimum":0.0,"title":"Current Spend","description":"Current spend in USD"},"max_budget":{"type":"number","exclusiveMinimum":0.0,"title":"Max Budget","description":"Maximum budget in USD"},"utilization_pct":{"type":"number","minimum":0.0,"title":"Utilization Pct","description":"Budget utilization %"},"models_breakdown":{"items":{"$ref":"#/components/schemas/ModelSpendResponse"},"type":"array","title":"Models Breakdown","description":"Per-model spend breakdown"},"last_updated":{"type":"string","format":"date-time","title":"Last Updated","description":"When spend was fetched from LiteLLM"},"budget_duration":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Budget Duration","description":"Budget period (e.g., '30d')"},"budget_reset_at":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Budget Reset At","description":"Budget reset timestamp"}},"type":"object","required":["tenant_id","current_spend","max_budget","utilization_pct","last_updated"],"title":"TenantSpendResponse","description":"Real-time spend data for a tenant from LiteLLM.\n\nAttributes:\n    tenant_id: Tenant identifier\n    current_spend: Current spend in USD\n    max_budget: Maximum budget in USD\n    utilization_pct: Budget utilization percentage (0-100+)\n    models_breakdown: List of per-model spend details\n    last_updated: When spend data was fetched from LiteLLM\n    budget_duration: Budget period (e.g., '30d')\n    budget_reset_at: When budget resets (ISO 8601 format)","example":{"budget_duration":"30d","budget_reset_at":"2025-12-07T00:00:00Z","current_spend":45.67,"last_updated":"2025-11-07T12:30:45.123456Z","max_budget":500.0,"models_breakdown":[{"model":"gpt-4","percentage":66.7,"requests":125,"spend":30.5},{"model":"claude-3-opus","percentage":33.3,"requests":45,"spend":15.17}],"tenant_id":"acme-corp","utilization_pct":9.13}},"TestComparisonRequest":{"properties":{"test_id_1":{"type":"string","format":"uuid","title":"Test Id 1","description":"First test execution ID"},"test_id_2":{"type":"string","format":"uuid","title":"Test Id 2","description":"Second test execution ID"}},"type":"object","required":["test_id_1","test_id_2"],"title":"TestComparisonRequest","description":"Request to compare two test results.\n\nAttributes:\n    test_id_1: First test execution ID\n    test_id_2: Second test execution ID"},"TestComparisonResult":{"properties":{"test_id_1":{"type":"string","format":"uuid","title":"Test Id 1","description":"First test ID"},"test_id_2":{"type":"string","format":"uuid","title":"Test Id 2","description":"Second test ID"},"status_changed":{"type":"boolean","title":"Status Changed","description":"True if status differs"},"token_delta":{"type":"integer","title":"Token Delta","description":"Difference in total tokens"},"cost_delta":{"type":"number","title":"Cost Delta","description":"Difference in estimated cost"},"timing_delta":{"type":"number","title":"Timing Delta","description":"Difference in duration ms"},"trace_differences":{"items":{"type":"string"},"type":"array","title":"Trace Differences","description":"List of differences in execution trace"}},"type":"object","required":["test_id_1","test_id_2","status_changed","token_delta","cost_delta","timing_delta"],"title":"TestComparisonResult","description":"Result of comparing two test executions.\n\nAttributes:\n    test_id_1: First test ID\n    test_id_2: Second test ID\n    status_changed: True if status differs\n    token_delta: Difference in tokens (test2 - test1)\n    cost_delta: Difference in cost (test2 - test1)\n    timing_delta: Difference in duration (test2 - test1)\n    trace_differences: List of differences in execution trace"},"TestConnectionRequest":{"properties":{"spec":{"additionalProperties":true,"type":"object","title":"Spec","description":"OpenAPI spec"},"auth_config":{"additionalProperties":true,"type":"object","title":"Auth Config","description":"Auth config"}},"type":"object","required":["spec"],"title":"TestConnectionRequest","description":"Schema for test connection request."},"TestConnectionResponse":{"properties":{"success":{"type":"boolean","title":"Success"},"status_code":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Status Code"},"response_preview":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Response Preview"},"error_message":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Message"},"error_type":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Error Type"},"test_endpoint":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Test Endpoint"}},"type":"object","required":["success"],"title":"TestConnectionResponse","description":"Schema for test connection response."},"TokenBreakdownDTO":{"properties":{"model_name":{"type":"string","title":"Model Name"},"prompt_tokens":{"type":"integer","minimum":0.0,"title":"Prompt Tokens","description":"Input tokens"},"completion_tokens":{"type":"integer","minimum":0.0,"title":"Completion Tokens","description":"Output tokens"},"total_tokens":{"type":"integer","minimum":0.0,"title":"Total Tokens","description":"Total tokens"},"prompt_percentage":{"type":"number","maximum":100.0,"minimum":0.0,"title":"Prompt Percentage","description":"Percentage of input tokens"},"completion_percentage":{"type":"number","maximum":100.0,"minimum":0.0,"title":"Completion Percentage","description":"Percentage of output tokens"}},"type":"object","required":["model_name","prompt_tokens","completion_tokens","total_tokens","prompt_percentage","completion_percentage"],"title":"TokenBreakdownDTO","description":"Token usage breakdown by type.\n\nUsed for AC#4 (pie chart of input vs output tokens)."},"TokenResponse":{"properties":{"access_token":{"type":"string","title":"Access Token"},"refresh_token":{"type":"string","title":"Refresh Token"},"token_type":{"type":"string","title":"Token Type","default":"bearer"},"expires_in":{"type":"integer","title":"Expires In"}},"type":"object","required":["access_token","refresh_token","expires_in"],"title":"TokenResponse","description":"OAuth2 token response.","example":{"access_token":"eyJhbGciOiJIUzI1NiIs...","expires_in":604800,"refresh_token":"eyJhbGciOiJIUzI1NiIs...","token_type":"bearer"}},"TokenUsage":{"properties":{"input_tokens":{"type":"integer","minimum":0.0,"title":"Input Tokens","description":"Input tokens used"},"output_tokens":{"type":"integer","minimum":0.0,"title":"Output Tokens","description":"Output tokens generated"},"total_tokens":{"type":"integer","minimum":0.0,"title":"Total Tokens","description":"Total tokens"},"estimated_cost_usd":{"type":"number","minimum":0.0,"title":"Estimated Cost Usd","description":"Estimated cost in USD"}},"type":"object","required":["input_tokens","output_tokens","total_tokens","estimated_cost_usd"],"title":"TokenUsage","description":"Token usage and cost tracking.\n\nAttributes:\n    input_tokens: Tokens in LLM prompts\n    output_tokens: Tokens in LLM responses\n    total_tokens: Sum of input + output\n    estimated_cost_usd: Estimated cost based on model pricing"},"ToolCall":{"properties":{"tool_name":{"type":"string","title":"Tool Name","description":"Name of the tool invoked"},"tool_input":{"additionalProperties":true,"type":"object","title":"Tool Input","description":"Input arguments to the tool"},"tool_output":{"type":"string","title":"Tool Output","description":"Output returned by the tool"},"timestamp":{"type":"string","title":"Timestamp","description":"ISO 8601 timestamp of invocation"}},"type":"object","required":["tool_name","tool_input","tool_output","timestamp"],"title":"ToolCall","description":"Tool call record in execution history."},"TransportType":{"type":"string","enum":["stdio","http_sse"],"title":"TransportType","description":"MCP server transport protocol types.\n\nAttributes:\n    STDIO: Subprocess communication via stdin/stdout (JSON-RPC over pipes)\n    HTTP_SSE: HTTP with Server-Sent Events for streaming (future support)"},"TriggerType":{"type":"string","enum":["webhook","schedule"],"title":"TriggerType","description":"Agent trigger types.\n\nWEBHOOK: HTTP POST webhook trigger (external systems push events)\nSCHEDULE: Cron-based scheduled execution (periodic tasks)"},"UnifiedTool":{"properties":{"id":{"type":"string","format":"uuid","title":"Id","description":"Unique tool identifier"},"name":{"type":"string","title":"Name","description":"Tool name for LLM invocation"},"description":{"type":"string","title":"Description","description":"Human-readable tool description"},"source_type":{"$ref":"#/components/schemas/SourceType","description":"Source type: openapi or mcp"},"openapi_tool_id":{"anyOf":[{"type":"integer"},{"type":"null"}],"title":"Openapi Tool Id","description":"Original OpenAPI tool integer ID (null for MCP tools)"},"mcp_server_id":{"anyOf":[{"type":"string","format":"uuid"},{"type":"null"}],"title":"Mcp Server Id","description":"MCP server ID (null for OpenAPI tools)"},"mcp_primitive_type":{"anyOf":[{"$ref":"#/components/schemas/MCPPrimitiveType"},{"type":"null"}],"description":"MCP primitive type (null for OpenAPI tools)"},"mcp_server_name":{"anyOf":[{"type":"string"},{"type":"null"}],"title":"Mcp Server Name","description":"MCP server name (null for OpenAPI tools)"},"input_schema":{"additionalProperties":true,"type":"object","title":"Input Schema","description":"JSON Schema for input validation"},"enabled":{"type":"boolean","title":"Enabled","description":"Whether tool is enabled","default":true}},"type":"object","required":["id","name","description","source_type","input_schema"],"title":"UnifiedTool","description":"Unified tool schema combining OpenAPI tools and MCP primitives.\n\nThis schema provides a consistent interface for tools from different sources,\nenabling agents to discover and use tools regardless of their origin.\n\nAttributes:\n    id: Unique identifier (UUID from OpenAPI tool or deterministic UUID5 for MCP)\n    name: Tool name (operationId for OpenAPI, tool/resource/prompt name for MCP)\n    description: Human-readable description for LLM context\n    source_type: Source indicator (\"openapi\" or \"mcp\")\n    openapi_tool_id: Original OpenAPI tool integer ID (null for MCP tools)\n    mcp_server_id: MCP server ID (null for OpenAPI tools)\n    mcp_primitive_type: MCP type (\"tool\", \"resource\", \"prompt\" - null for OpenAPI)\n    mcp_server_name: MCP server name for disambiguation (null for OpenAPI)\n    input_schema: JSON Schema for input validation (parameters_schema for OpenAPI)\n    enabled: Whether tool is enabled for use","example":{"description":"Get current weather information for a location","enabled":true,"id":"550e8400-e29b-41d4-a716-446655440000","input_schema":{"properties":{"location":{"description":"City name or zip code","type":"string"}},"required":["location"],"type":"object"},"name":"get_weather","source_type":"openapi"}},"UserDetailResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"email":{"type":"string","format":"email","title":"Email"},"default_tenant_id":{"type":"string","format":"uuid","title":"Default Tenant Id"},"roles":{"items":{"$ref":"#/components/schemas/RoleAssignment"},"type":"array","title":"Roles"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"last_login_at":{"anyOf":[{"type":"string","format":"date-time"},{"type":"null"}],"title":"Last Login At"},"is_active":{"type":"boolean","title":"Is Active"}},"type":"object","required":["id","email","default_tenant_id","roles","created_at","last_login_at","is_active"],"title":"UserDetailResponse","description":"Detailed user profile with roles.","example":{"created_at":"2025-11-18T10:00:00Z","default_tenant_id":"123e4567-e89b-12d3-a456-426614174000","email":"user@example.com","id":"123e4567-e89b-12d3-a456-426614174000","is_active":true,"last_login_at":"2025-11-18T14:30:00Z","roles":[{"role":"admin","tenant_id":"123e4567-e89b-12d3-a456-426614174000"},{"role":"viewer","tenant_id":"987e6543-e21b-12d3-a456-426614174000"}]}},"UserResponse":{"properties":{"id":{"type":"string","format":"uuid","title":"Id"},"email":{"type":"string","format":"email","title":"Email"},"default_tenant_id":{"type":"string","format":"uuid","title":"Default Tenant Id"},"created_at":{"type":"string","format":"date-time","title":"Created At"},"is_active":{"type":"boolean","title":"Is Active"}},"type":"object","required":["id","email","default_tenant_id","created_at","is_active"],"title":"UserResponse","description":"User response (password excluded)."},"ValidationError":{"properties":{"loc":{"items":{"anyOf":[{"type":"string"},{"type":"integer"}]},"type":"array","title":"Location"},"msg":{"type":"string","title":"Message"},"type":{"type":"string","title":"Error Type"}},"type":"object","required":["loc","msg","type"],"title":"ValidationError"},"WebhookPayload":{"properties":{"event":{"type":"string","minLength":1,"title":"Event","description":"Type of webhook event","example":"ticket_created"},"ticket_id":{"type":"string","maxLength":100,"minLength":1,"title":"Ticket Id","description":"Unique ticket identifier from ServiceDesk Plus","example":"TKT-001"},"tenant_id":{"type":"string","maxLength":100,"minLength":1,"title":"Tenant Id","description":"Client/tenant identifier for multi-tenant support","example":"tenant-abc"},"description":{"type":"string","maxLength":10000,"minLength":1,"title":"Description","description":"Ticket description or problem statement","example":"Server is slow and unresponsive"},"priority":{"type":"string","enum":["low","medium","high","critical"],"title":"Priority","description":"Ticket priority level","example":"high"},"created_at":{"type":"string","format":"date-time","title":"Created At","description":"ISO 8601 timestamp of ticket creation with timezone","example":"2025-11-01T12:00:00Z"},"correlation_id":{"anyOf":[{"type":"string","maxLength":36,"minLength":36},{"type":"null"}],"title":"Correlation Id","description":"Optional request correlation ID for distributed tracing (UUID v4 format)","example":"550e8400-e29b-41d4-a716-446655440000"}},"additionalProperties":false,"type":"object","required":["event","ticket_id","tenant_id","description","priority","created_at"],"title":"WebhookPayload","description":"Schema for webhook payloads from ServiceDesk Plus.\n\nValidates incoming webhook notifications when tickets are created or updated.\nEnforces field requirements, types, and lengths per Epic 3 Story 3.4 security specs.\n\nAttributes:\n    event: Type of webhook event (e.g., \"ticket_created\")\n    ticket_id: Unique identifier (alphanumeric + dashes, max 100 chars)\n    tenant_id: Tenant identifier (lowercase alphanumeric + dashes, max 100 chars)\n    description: Ticket description (max 10,000 chars)\n    priority: Ticket priority level (low, medium, high, critical)\n    created_at: ISO 8601 timestamp with timezone (naive datetimes rejected)\n\nRaises:\n    ValidationError: If any field fails validation (invalid format, missing timezone, etc.)","example":{"correlation_id":"550e8400-e29b-41d4-a716-446655440000","created_at":"2025-11-01T12:00:00Z","description":"Server is slow and unresponsive","event":"ticket_created","priority":"high","tenant_id":"tenant-abc","ticket_id":"TKT-001"}},"WebhookResponse":{"properties":{"status":{"type":"string","title":"Status","description":"Response status","example":"accepted"},"job_id":{"type":"string","title":"Job Id","description":"Unique job identifier for tracking","example":"550e8400-e29b-41d4-a716-446655440000"},"message":{"type":"string","title":"Message","description":"Confirmation message","example":"Enhancement job queued successfully"}},"type":"object","required":["status","job_id","message"],"title":"WebhookResponse","description":"Response schema for webhook endpoint (202 Accepted).\n\nAttributes:\n    status: Response status indicator (\"accepted\")\n    job_id: Unique job identifier for tracking the enhancement job\n    message: Human-readable confirmation message","example":{"job_id":"550e8400-e29b-41d4-a716-446655440000","message":"Enhancement job queued successfully","status":"accepted"}}},"securitySchemes":{"JWT":{"type":"oauth2","flows":{"password":{"scopes":{},"tokenUrl":"/api/auth/token"}}}}}}